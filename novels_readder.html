<!DOCTYPE html>
<!-- 
	HTML5文檔類型聲明
	告訴瀏覽器這是一個HTML5文檔，確保使用最新的HTML標準
-->
<html lang="zh-TW">
<!-- 
	根元素，lang屬性指定頁面的主要語言為繁體中文
	這有助於搜索引擎優化(SEO)和無障礙功能
-->
<head>
	<!-- 
		head標籤包含頁面的元數據(metadata)
		這些內容不會直接顯示在頁面上，但對瀏覽器和搜索引擎很重要
	-->
	<meta charset="UTF-8">
	<!-- 
		設定字符編碼為UTF-8，支持多國語言字符
		UTF-8是最常用的字符編碼，能顯示幾乎所有語言的文字
	-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- 
		響應式設計的重要設定
		width=device-width: 視窗寬度等於設備寬度
		initial-scale=1.0: 初始縮放比例為100%
		這確保網頁在移動設備上正確顯示
	-->
	<title>輕小說翻譯</title>
	<!-- 
		網頁標題，顯示在瀏覽器標籤頁上
		也是搜索引擎結果中顯示的標題
	-->
	<link rel="icon" href="images/favicon.jpg" type="image/jpg">
	<!-- 
		設定網站圖標(favicon)
		顯示在瀏覽器標籤頁和書籤中的小圖標
	-->
	<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
	<!-- 
		引入Vue.js 3框架
		Vue是一個漸進式JavaScript框架，用於構建用戶界面
		使用CDN方式引入，無需本地下載
	-->
	<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
	<!-- 
		引入Marked.js庫
		Marked是一個Markdown解析器，能將Markdown格式轉換為HTML
		用於處理小說內容的格式化顯示
	-->
	<style>
		/* 
			CSS樣式表開始
			使用內部樣式表(embedded stylesheet)
			緊湊格式：移除運算符和符號周圍的空格以減少文件大小
		*/
		:root{
			/* 
				CSS自定義屬性(CSS變量)定義
				:root選擇器表示文檔的根元素
				自定義屬性以--開頭，可以在整個文檔中重複使用
				這種方式便於統一管理顏色、尺寸等設計標準
			*/
			
			/* 顏色系統變量 - 用於統一管理整個網站的色彩方案 */
			--primary:#4a90e2;          /* 主色調：藍色，用於按鈕、鏈接等重要元素 */
			--primary-hover:#357abd;     /* 主色調懸停狀態：較深的藍色 */
			--bg:#fff;                   /* 主要背景顏色：白色 */
			--text:#333;                 /* 主要文字顏色：深灰色 */
			--text-muted:#666;           /* 次要文字顏色：中灰色，用於不太重要的文字 */
			--border:#ddd;               /* 邊框顏色：淺灰色 */
			--secondary:#f5f5f5;         /* 次要顏色：淺灰色，用於背景 */
			--shadow:0 2px 8px rgba(0,0,0,0.15); /* 陰影效果 */
			--fs:18px;                   /* 基礎字體大小(可通過設定調整) */
			--lh:1.8;                    /* 行高，影響文字的垂直間距 */
			--br:8px;                    /* 圓角大小 */
			--sp:1rem;                   /* 標準間距單位 */
			--bg-rgb:255,255,255;        /* 背景顏色的RGB值，用於透明度計算 */
		}
		:root[data-theme="dark"]{
			/* 
				暗色主題的CSS變量重定義
				使用屬性選擇器[data-theme="dark"]來指定暗色主題
				當根元素有data-theme="dark"屬性時，使用這些顏色
			*/
			--primary:#64b5f6;          /* 暗色主題的主色調：較亮的藍色 */
			--bg:#121212;               /* 暗色主題的主要背景顏色：深黑色 */
			--text:#e0e0e0;             /* 暗色主題的主要文字顏色：淺灰色 */
			--text-muted:#999;          /* 暗色主題的次要文字顏色 */
			--border:#333;              /* 暗色主題的邊框顏色：深灰色 */
			--secondary:#1a1a1a;        /* 暗色主題的次要顏色：深灰色 */
			--bg-rgb:18,18,18;          /* 暗色主題背景的RGB值 */
		}
		*{
			/* 
				通用重置樣式
				*: 選擇所有元素
				確保所有元素都有一致的盒模型
			*/
			margin:0;                          /* 移除所有元素的默認外邊距 */
			padding:0;                         /* 移除所有元素的默認內邊距 */
			box-sizing:border-box;             /* 使用border-box盒模型：寬高包含padding和border */
		}
		body{
			/* 
				頁面主體樣式
				設定整個網頁的基礎屬性和字體
			*/
			font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
			/* 
				字體堆疊(font stack)：按優先級列出多個字體
				-apple-system: 蘋果系統默認字體
				BlinkMacSystemFont: 舊版蘋果系統字體
				"Segoe UI": Windows系統字體
				Roboto: Android系統字體
				sans-serif: 通用無襯線字體(備用)
			*/
			line-height:var(--lh);             /* 使用CSS變量設定行高 */
			color:var(--text);                 /* 使用CSS變量設定文字顏色 */
			background:var(--secondary);       /* 使用CSS變量設定背景顏色 */
			padding-top:60px;                  /* 頂部內邊距，為固定導航欄留出空間 */
			min-height:100vh;                  /* 最小高度為視窗高度 */
			transition:all 0.3s;               /* 所有屬性變化的過渡動畫(主題切換) */
		}
		.container{
			/* 
				主要內容容器
				使用最大寬度和自動邊距來居中內容
			*/
			max-width:1200px;                  /* 最大寬度限制 */
			margin:var(--sp) auto;             /* 上邊距、左右自動(居中) */
			padding:20px;                      /* 內邊距 */
		}
		.navbar{
			/* 
				導航欄樣式
				使用fixed定位來創建固定在頂部的導航欄
			*/
			position:fixed;                     /* 固定定位：不隨頁面滾動 */
			top:0;                             /* 距離頂部0像素 */
			left:0;                            /* 距離左側0像素 */
			right:0;                           /* 距離右側0像素 */
			background:rgba(var(--bg-rgb),0.85); /* 半透明背景，85%透明度 */
			box-shadow:var(--shadow);          /* 使用CSS變量設定陰影 */
			padding:var(--sp);                 /* 使用CSS變量設定內邊距 */
			z-index:1000;                      /* 層級設定，確保在其他元素之上 */
			transition:transform 0.3s;         /* 變換效果的過渡動畫(滑動隱藏) */
		}
		.nav-container{
			/* 
				導航欄內容容器
				使用Flexbox來創建響應式導航佈局
			*/
			max-width:1200px;                  /* 最大寬度限制 */
			margin:0 auto;                     /* 水平居中 */
			display:flex;                      /* 使用Flexbox佈局 */
			justify-content:space-between;     /* 主軸方向兩端對齊(左右分佈) */
			align-items:center;                /* 交叉軸方向居中對齊(垂直居中) */
			gap:var(--sp);                     /* Flexbox項目之間的間距 */
		}
		.nav-left,.nav-right{
			/* 
				導航欄左右區域
				使用Flexbox來排列子元素
			*/
			display:flex;                      /* 使用Flexbox佈局 */
			align-items:center;                /* 垂直居中對齊 */
			gap:var(--sp);                     /* 子元素之間的間距 */
		}
		.nav-title{
			/* 
				導航欄標題樣式
				作為可點擊的標題鏈接
			*/
			color:var(--primary);              /* 使用主色調 */
			text-decoration:none;              /* 移除下劃線 */
			font-size:1.3rem;                 /* 字體大小 */
			font-weight:bold;                  /* 粗體 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
		}
		.dropdown{
			/* 
				下拉菜單容器
				使用相對定位作為絕對定位子元素的參考點
			*/
			position:relative;                 /* 相對定位：為子元素提供定位上下文 */
			z-index:1001;                      /* 設定層級，確保下拉菜單在其他元素之上 */
		}
		.dropdown-toggle{
			/* 
				下拉菜單觸發按鈕
				使用Flexbox來對齊內部元素
			*/
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			padding:0.5rem 0;                 /* 上下內邊距，左右為0 */
			display:flex;                      /* 使用Flexbox佈局 */
			align-items:center;                /* 垂直居中對齊 */
			gap:0.5rem;                        /* 子元素間距 */
			color:var(--text);                 /* 文字顏色 */
			background:none;                   /* 無背景 */
			border:none;                       /* 無邊框 */
			font-size:1.1rem;                 /* 字體大小 */
		}
		.dropdown-toggle::after{
			/* 
				使用CSS偽元素添加下拉箭頭
				::after偽元素在元素內容之後插入內容
			*/
			content:'▼';                       /* 插入向下箭頭符號 */
			font-size:0.8em;                  /* 相對字體大小 */
			transition:transform 0.3s;         /* 變換效果的過渡動畫 */
		}
		.dropdown-toggle.active::after{
			/* 
				下拉菜單展開時的箭頭狀態
				.active類表示菜單已展開
			*/
			transform:rotate(180deg);          /* 旋轉180度，箭頭朝上 */
		}
		.dropdown-menu{
			/* 
				下拉菜單樣式
				使用固定定位和動畫效果
			*/
			position:fixed;                    /* 固定定位：相對於視窗定位 */
			background:var(--bg);              /* 背景顏色 */
			min-width:160px;                   /* 最小寬度 */
			box-shadow:var(--shadow);          /* 陰影效果 */
			border-radius:var(--br);           /* 圓角 */
			opacity:0;                         /* 初始透明(隱藏) */
			visibility:hidden;                 /* 隱藏元素(不佔空間) */
			transform:translateY(-10px);       /* 向上偏移10像素 */
			transition:all 0.3s;               /* 所有屬性變化的過渡動畫 */
			z-index:1002;                      /* 設定較高的層級 */
			padding:4px;                       /* 內邊距 */
		}
		.dropdown-menu.show{
			/* 
				菜單顯示狀態
				.show類用於控制菜單的顯示/隱藏
			*/
			opacity:1;                         /* 完全不透明 */
			visibility:visible;                /* 顯示元素 */
			transform:translateY(0);           /* 恢復原位置 */
		}
		.dropdown-menu a{
			/* 
				下拉菜單項目的樣式
			*/
			display:block;                     /* 塊級元素：佔滿一行 */
			padding:0.8rem var(--sp);          /* 內邊距 */
			color:var(--text);                 /* 文字顏色 */
			text-decoration:none;              /* 移除下劃線 */
			transition:background 0.3s;        /* 背景顏色過渡動畫 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			border-radius:var(--br);           /* 圓角 */
		}
		.dropdown-menu a:hover{
			/* 
				菜單項目懸停狀態
				:hover偽類選擇器在滑鼠懸停時觸發
			*/
			background:var(--secondary);       /* 懸停背景顏色 */
			color:var(--primary);              /* 懸停文字顏色 */
		}
		.theme-toggle{
			/* 
				主題切換按鈕
				用於在明暗主題間切換
			*/
			background:none;                   /* 無背景 */
			border:none;                       /* 無邊框 */
			color:var(--text);                 /* 文字顏色 */
			font-size:1.5rem;                 /* 較大字體 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			padding:0.5rem;                    /* 內邊距 */
			transition:transform 0.3s;         /* 變換效果的過渡動畫 */
		}
		.theme-toggle:hover{
			/* 
				主題切換按鈕懸停效果
				添加360度旋轉動畫
			*/
			transform:rotate(360deg);          /* 旋轉360度 */
		}
		.content-grid{
			/* 
				內容網格佈局 - 小說卡片的容器
				使用CSS Grid來創建響應式的卡片佈局
			*/
			display:grid;                      /* 使用CSS Grid佈局 */
			grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
			/* 
				grid-template-columns: 定義列的數量和大小
				repeat(auto-fill, minmax(200px, 1fr)): 
				- auto-fill: 自動填充盡可能多的列
				- minmax(200px, 1fr): 每列最小200px，最大為可用空間的等份
				- 這樣可以根據螢幕寬度自動調整列數
			*/
			gap:var(--sp);                     /* 網格項目之間的間距 */
		}
		.content-card{
			/* 
				小說卡片樣式
				使用Flexbox佈局來處理內部元素排列
			*/
			width:196px;                       /* 固定寬度 */
			background:var(--bg);              /* 背景顏色 */
			border-radius:var(--br);           /* 圓角 */
			overflow:hidden;                   /* 隱藏超出邊界的內容(圓角圖片) */
			box-shadow:var(--shadow);          /* 陰影效果 */
			transition:all 0.2s;               /* 所有屬性變化的過渡動畫 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			display:flex;                      /* 使用Flexbox佈局 */
			flex-direction:column;             /* 垂直排列(上下結構) */
		}
		.content-card:hover{
			/* 
				卡片懸停效果
				創建懸浮效果增加互動感
			*/
			transform:translateY(-5px);        /* 向上移動5像素 */
		}
		.content-card img{
			/* 
				卡片封面圖片樣式
				確保圖片比例一致且填滿容器
			*/
			width:196px;                       /* 固定寬度 */
			height:280px;                      /* 固定高度 */
			object-fit:cover;                  /* 保持縱橫比並裁剪超出部分 */
		}
		.content-card-info{
			/* 
				卡片信息區域
				包含標題、作者和更新時間
			*/
			padding:var(--sp);                 /* 內邊距 */
			background:var(--bg);              /* 背景顏色 */
			flex:1;                            /* 佔據剩餘空間 */
			display:flex;                      /* 使用Flexbox佈局 */
			flex-direction:column;             /* 垂直排列 */
			justify-content:space-between;     /* 垂直方向兩端對齊 */
		}
		.content-title{
			/* 小說標題樣式 */
			font-size:1.1rem;                 /* 較大字體 */
			font-weight:bold;                  /* 粗體 */
			color:var(--text);                 /* 文字顏色 */
		}
		.card-footer{
			/* 
				卡片底部信息
				顯示作者和更新時間
			*/
			display:flex;                      /* 使用Flexbox佈局 */
			justify-content:space-between;     /* 兩端對齊(作者在左，時間在右) */
			align-items:center;                /* 垂直居中對齊 */
			margin-top:0.5rem;                 /* 上邊距 */
			font-size:0.8rem;                 /* 較小字體 */
			color:var(--text-muted);           /* 次要文字顏色 */
		}
		.novel-detail{
			/* 
				小說詳情頁面的主容器
				包含小說封面、信息和章節列表
			*/
			background:var(--bg);              /* 背景顏色 */
			border-radius:var(--br);           /* 圓角 */
			padding:2rem;                      /* 內邊距 */
			margin-bottom:2rem;                /* 下邊距 */
		}
		.novel-info{
			/* 
				小說基本信息區域
				使用Grid佈局將封面和詳細信息並排顯示
			*/
			display:grid;                      /* 使用CSS Grid佈局 */
			grid-template-columns:300px 1fr;   /* 第一列300px(封面)，第二列佔剩餘空間(信息) */
			gap:2rem;                          /* 列之間的間距 */
		}
		.novel-cover{
			/* 
				小說封面圖片樣式
				可點擊放大查看
			*/
			width:100%;                        /* 寬度佔滿容器 */
			border-radius:var(--br);           /* 圓角 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
		}
		.novel-title{
			/* 小說標題樣式 */
			font-size:2.3rem;                 /* 大字體 */
			margin-bottom:var(--sp);           /* 下邊距 */
			color:var(--text);                 /* 文字顏色 */
		}
		.novel-metadata{
			/* 
				小說元數據區域
				包含作者、類型等信息
			*/
			margin-bottom:var(--sp);           /* 下邊距 */
			color:var(--text);                 /* 文字顏色 */
		}
		.novel-description{
			/* 
				小說描述/簡介樣式
				支持多行文字和換行顯示
			*/
			margin-top:var(--sp);              /* 上邊距 */
			line-height:1.8;                   /* 行高 */
			white-space:pre-line;              /* 保留換行符並自動換行 */
		}
		.source-link{
			/* 
				原文鏈接按鈕樣式
				用於鏈接到原始網站
			*/
			display:inline-block;              /* 內聯塊元素：可設定寬高但保持在行內 */
			padding:0.25rem 0.75rem;           /* 內邊距：上下小，左右大 */
			margin-left:0.5rem;                /* 左邊距 */
			border-radius:var(--br);           /* 圓角 */
			color:var(--text);                 /* 文字顏色 */
			background:var(--secondary);       /* 背景顏色 */
			text-decoration:none;              /* 移除下劃線 */
			transition:all 0.2s;               /* 所有屬性變化的過渡動畫 */
		}
		.source-link:hover{
			/* 
				鏈接懸停效果
				改變背景和文字顏色
			*/
			background:var(--primary-hover);   /* 懸停背景顏色 */
			color:#fff;                        /* 懸停文字顏色：白色 */
		}
		.chapter-list{
			/* 
				章節列表容器
				使用Grid佈局創建響應式的章節卡片網格
			*/
			display:grid;                      /* 使用CSS Grid佈局 */
			grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
			/* 
				自動填充網格列，每列最小150px
				根據容器寬度自動調整列數
			*/
			gap:var(--sp);                     /* 網格項目之間的間距 */
			margin-top:2rem;                   /* 上邊距 */
		}
		.chapter-item{
			/* 
				單個章節項目的樣式
				每個章節都是一個可點擊的卡片
			*/
			background:var(--secondary);       /* 背景顏色 */
			padding:var(--sp);                 /* 內邊距 */
			border-radius:var(--br);           /* 圓角 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			transition:all 0.2s;               /* 所有屬性變化的過渡動畫 */
			display:flex;                      /* 使用Flexbox佈局 */
			flex-direction:column;             /* 垂直排列 */
			gap:0.5rem;                        /* 子元素間距 */
		}
		.chapter-item:hover{
			/* 
				章節項目懸停效果
				創建視覺反饋增強用戶體驗
			*/
			background:var(--primary);         /* 懸停背景顏色：主色調 */
			color:#fff;                        /* 懸停文字顏色：白色 */
			transform:translateY(-2px);        /* 向上移動2像素，創建懸浮效果 */
		}
		.chapter-item.read{
			/* 
				已讀章節的特殊樣式
				.read類用於標記用戶已經閱讀過的章節
			*/
			opacity:0.5;                       /* 降低透明度至50% */
			border:1px solid rgba(0,0,0,0.1);  /* 添加淺色邊框 */
		}
		.chapter-item.read:hover{
			/* 
				已讀章節的懸停效果
				覆蓋已讀章節的透明度設定，讓懸停時顯示完整效果
			*/
			background:var(--primary)!important; /* 強制設定藍色背景 */
			color:#fff!important;              /* 強制設定白色文字 */
		}
		.chapter-title{
			/* 章節標題樣式 */
			font-weight:500;                   /* 中等粗細字體 */
			flex-grow:1;                       /* 佔據剩餘空間 */
		}
		.chapter-date{
			/* 章節日期樣式 */
			font-size:0.85rem;                 /* 較小字體 */
			color:var(--text-muted);           /* 次要文字顏色 */
		}
		.reader-container{
			/* 
				閱讀器主容器
				為小說內容提供最佳的閱讀體驗
			*/
			max-width:800px;                   /* 最大寬度限制，避免行太長影響閱讀 */
			margin:4rem auto 5rem;             /* 上邊距4rem，左右自動居中，下邊距5rem */
			padding:2rem;                      /* 內邊距 */
			background:var(--bg);              /* 背景顏色 */
			border-radius:var(--br);           /* 圓角 */
			box-shadow:var(--shadow);          /* 陰影效果 */
			font-size:var(--fs);               /* 字體大小(可通過設定調整) */
		}
		.novel-content{
			/* 
				小說正文內容區域
				包含實際的小說文字和圖片
			*/
			margin-bottom:2rem;                /* 下邊距 */
			user-select:none;                  /* 禁止用戶選擇文字(防止意外選中) */
		}
		.novel-content p{
			/* 
				小說內容段落樣式
				確保段落間有適當間距
			*/
			margin-bottom:var(--sp);           /* 段落下邊距 */
		}
		.novel-content img{
			/* 
				小說內容中的圖片樣式
				確保圖片響應式顯示且可點擊放大
			*/
			max-width:100%;                    /* 最大寬度不超過容器 */
			height:auto;                       /* 高度自動，保持縱橫比 */
			display:block;                     /* 塊級元素：獨佔一行 */
			margin:var(--sp) auto;             /* 上下邊距，左右自動居中 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			border-radius:var(--br);           /* 圓角 */
		}
		.control-btn{
			/* 
				控制按鈕的基礎樣式
				用於各種操作按鈕(上一章、下一章、設定等)
			*/
			padding:0.5rem var(--sp);          /* 內邊距：上下小，左右大 */
			border:none;                       /* 移除默認邊框 */
			border-radius:var(--br);           /* 圓角 */
			background:var(--primary);         /* 主色調背景 */
			color:white;                       /* 白色文字 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			min-width:80px;                    /* 最小寬度，確保按鈕大小一致 */
			transition:background 0.2s;        /* 背景顏色變化的過渡動畫 */
		}
		.control-btn:hover{
			/* 控制按鈕懸停效果 */
			background:var(--primary-hover);   /* 懸停時使用較深的主色調 */
		}
		.control-btn:disabled{
			/* 
				禁用狀態的按鈕樣式
				當按鈕不可用時(如已經是第一章/最後一章)
			*/
			opacity:0.5;                       /* 透明度50%，視覺上表示禁用 */
			cursor:not-allowed;                /* 滑鼠懸停時顯示禁用游標 */
		}
		.back-btn{
			/* 
				返回按鈕的特殊樣式
				覆蓋通用控制按鈕樣式
			*/
			background:transparent;            /* 透明背景 */
			min-width:auto;                    /* 移除最小寬度限制 */
			padding:0.5rem;                    /* 統一內邊距 */
			color:var(--text);                 /* 文字顏色 */
			display:flex;                      /* 使用Flexbox佈局 */
			align-items:center;                /* 垂直居中對齊 */
			margin-right:var(--sp);            /* 右邊距 */
		}
		.back-btn:hover{
			/* 返回按鈕懸停效果 */
			background:transparent;            /* 保持透明背景 */
			color:var(--primary);              /* 懸停時使用主色調 */
		}
		.reader-controls{
			/* 
				閱讀器底部控制欄
				包含上一章、下一章、目錄、設定等按鈕
			*/
			background:rgba(var(--bg-rgb),0.85); /* 半透明背景，與導航欄一致 */
			position:fixed;                    /* 固定定位：不隨頁面滾動 */
			bottom:0;                          /* 固定在底部 */
			left:0;                            /* 左側對齊 */
			right:0;                           /* 右側對齊(充滿寬度) */
			padding:var(--sp);                 /* 內邊距 */
			display:flex;                      /* 使用Flexbox佈局 */
			justify-content:center;            /* 水平居中對齊 */
			gap:var(--sp);                     /* 按鈕間距 */
			transition:transform 0.3s;         /* 變換效果的過渡動畫 */
			z-index:1000;                      /* 設定層級 */
		}
		.reader-controls.hidden{
			/* 
				隱藏狀態的控制欄
				當用戶向下滾動時自動隱藏
			*/
			transform:translateY(100%);        /* 向下移動100%，完全隱藏 */
		}
		.reader-title{
			/* 
				閱讀器導航欄中的章節標題
				顯示當前正在閱讀的章節名稱
			*/
			text-align:center;                 /* 文字居中 */
			flex-grow:1;                       /* 佔據剩餘空間 */
			margin:0 1rem;                     /* 左右邊距 */
		}
		.settings-modal{
			/* 
				設定模態框
				用於顯示閱讀設定和章節目錄
				從底部滑入的彈窗設計
			*/
			position:fixed;                    /* 固定定位：不隨頁面滾動 */
			bottom:60px;                       /* 距離底部60px(控制欄上方) */
			left:50%;                          /* 左邊距50%(配合transform居中) */
			transform:translate(-50%,200%);    /* 水平居中，垂直向下200%(初始隱藏) */
			width:300px;                       /* 固定寬度 */
			background:var(--bg);              /* 背景顏色 */
			border:1px solid var(--border);    /* 邊框 */
			border-radius:var(--br);           /* 圓角 */
			padding:1.5rem;                    /* 內邊距 */
			color:var(--text);                 /* 文字顏色 */
			z-index:1000;                      /* 層級設定 */
			transition:transform 0.3s;         /* 變換效果的過渡動畫 */
			max-height:60vh;                   /* 最大高度為視窗高度的60% */
			display:flex;                      /* 使用Flexbox佈局 */
			flex-direction:column;             /* 垂直排列 */
			box-shadow:var(--shadow);          /* 陰影效果 */
		}
		.settings-modal.active{
			/* 
				模態框顯示狀態
				.active類用於控制模態框的顯示/隱藏
			*/
			transform:translate(-50%,0);       /* 水平居中，垂直歸位(顯示) */
		}
		.settings-modal-header{
			/* 
				模態框標題欄
				使用黏性定位保持在頂部
			*/
			padding:0 0 var(--sp) 0;           /* 只有下內邊距 */
			border-bottom:1px solid var(--border); /* 底部分隔線 */
			font-weight:bold;                  /* 粗體 */
			text-align:center;                 /* 文字居中 */
			background:var(--bg);              /* 背景顏色(遮蓋滾動內容) */
		}
		.settings-group{
			/* 
				設定項目組容器
				可滾動的內容區域
			*/
			overflow-y:auto;                   /* 垂直方向自動滾動 */
			flex:1;                            /* 佔據剩餘空間 */
			margin:0;                          /* 移除外邊距 */
			padding:var(--sp) 0;               /* 上下內邊距 */
		}
		.settings-group label{
			/* 
				設定項目標籤樣式
				用於顯示設定項目的說明文字
			*/
			display:block;                     /* 塊級元素：獨佔一行 */
			margin-bottom:0.5rem;              /* 下邊距 */
			color:var(--text);                 /* 文字顏色 */
		}
		.settings-group input[type="range"]{
			/* 
				範圍滑桿樣式(字體大小、行距調整)
				使用CSS屬性選擇器選擇特定類型的input
			*/
			width:100%;                        /* 寬度佔滿容器 */
			accent-color:var(--primary);       /* 滑桿主色調 */
		}
		.settings-group input[type="checkbox"]{
			/* 
				複選框樣式(夜間模式開關)
				使用CSS屬性選擇器選擇checkbox類型的input
			*/
			margin-right:0.5rem;               /* 右邊距 */
			accent-color:var(--primary);       /* 複選框主色調 */
		}
		.settings-modal .chapter-item{
			/* 
				設定模態框中的章節項目樣式
				與主頁面章節項目類似，但針對模態框進行了調整
			*/
			background:var(--secondary);       /* 背景顏色 */
			padding:0.8rem;                    /* 內邊距 */
			border-radius:var(--br);           /* 圓角 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			transition:all 0.2s;               /* 所有屬性變化的過渡動畫 */
			margin-bottom:0.5rem;              /* 下邊距 */
			border:1px solid transparent;      /* 透明邊框(為懸停效果預留空間) */
		}
		.settings-modal .chapter-item.current{
			/* 
				當前正在閱讀章節的特殊樣式(明亮主題)
				使用藍色系突出顯示
			*/
			background:#bbdefb!important;      /* 淺藍色背景 */
			color:#000!important;              /* 黑色文字 */
		}
		:root[data-theme="dark"] .settings-modal .chapter-item.current{
			/* 當前正在閱讀章節的特殊樣式(暗色主題) */
			background:#1976d2!important;      /* 深藍色背景 */
			color:#fff!important;              /* 白色文字 */
		}
		.lightbox{
			/* 
				燈箱(圖片放大查看)容器
				用於全屏顯示圖片
			*/
			position:fixed;                    /* 固定定位：覆蓋整個視窗 */
			inset:0;                           /* 上下左右都為0(充滿整個視窗) */
			background:rgba(0,0,0,0.9);        /* 半透明黑色背景 */
			display:none;                      /* 初始隱藏 */
			justify-content:center;            /* 水平居中對齊 */
			align-items:center;                /* 垂直居中對齊 */
			z-index:2000;                      /* 最高層級(覆蓋所有元素) */
			opacity:0;                         /* 初始透明 */
			transition:opacity 0.3s;           /* 透明度變化的過渡動畫 */
		}
		.lightbox.active{
			/* 
				燈箱激活狀態
				.active類用於控制燈箱的顯示
			*/
			display:flex;                      /* 使用Flexbox佈局(顯示燈箱) */
			opacity:1;                         /* 完全不透明 */
		}
		.lightbox-content{
			/* 
				燈箱內容容器
				包含圖片和關閉按鈕
			*/
			position:relative;                 /* 相對定位：為子元素提供定位上下文 */
			max-width:95%;                     /* 最大寬度95%(留出邊距) */
			max-height:85vh;                   /* 最大高度85%(留出空間給關閉按鈕) */
		}
		.lightbox img{
			/* 
				燈箱中的圖片樣式
				確保圖片在容器中正確顯示
			*/
			max-width:100%;                    /* 最大寬度不超過容器 */
			max-height:85vh;                   /* 最大高度限制 */
			object-fit:contain;                /* 保持縱橫比並完整顯示 */
		}
		.close-lightbox{
			/* 
				燈箱關閉按鈕
				位於圖片右上角外側
			*/
			position:absolute;                 /* 絕對定位：相對於.lightbox-content */
			top:-40px;                         /* 向上偏移40px(圖片外側) */
			right:0;                           /* 右側對齊 */
			color:white;                       /* 白色文字 */
			font-size:24px;                    /* 較大字體 */
			cursor:pointer;                    /* 滑鼠懸停時顯示手型游標 */
			background:none;                   /* 無背景 */
			border:none;                       /* 無邊框 */
			padding:8px;                       /* 內邊距 */
		}
		.loading-overlay{
			/* 
				載入遮罩層
				在載入內容時顯示載入動畫
			*/
			position:fixed;                    /* 固定定位：覆蓋整個視窗 */
			inset:0;                           /* 上下左右都為0(充滿整個視窗) */
			background:rgba(0,0,0,0.7);        /* 半透明黑色背景 */
			display:none;                      /* 初始隱藏 */
			justify-content:center;            /* 水平居中對齊 */
			align-items:center;                /* 垂直居中對齊 */
			z-index:9999;                      /* 最高層級(載入時覆蓋所有元素) */
		}
		.loading-overlay.show{
			/* 
				載入遮罩顯示狀態
				.show類用於控制載入遮罩的顯示
			*/
			display:flex;                      /* 使用Flexbox佈局(顯示載入畫面) */
		}
		.loading-spinner{
			/* 
				載入動畫旋轉器
				創建旋轉的圓環載入動畫
			*/
			width:50px;                        /* 寬度 */
			height:50px;                       /* 高度 */
			border:4px solid rgba(255,255,255,0.3); /* 淺色圓環邊框 */
			border-top:4px solid white;        /* 頂部白色邊框(旋轉時形成動畫效果) */
			border-radius:50%;                 /* 圓形 */
			animation:spin 1s linear infinite; /* 旋轉動畫：1秒一圈，線性速度，無限循環 */
		}
		.loading-text{
			/* 載入文字樣式 */
			color:white;                       /* 白色文字 */
			margin-top:var(--sp);              /* 上邊距 */
			font-size:1.1rem;                 /* 較大字體 */
		}
		@keyframes spin{
			/* 
				旋轉動畫
				用於載入旋轉器的360度旋轉效果
			*/
			0%{transform:rotate(0deg);}        /* 起始：0度 */
			100%{transform:rotate(360deg);}    /* 結束：360度 */
		}
		.hidden{
			/* 
				通用隱藏類
				使用!important確保元素被隱藏
			*/
			display:none!important;
		}
		.navbar.hidden{
			/* 
				導航欄專用隱藏效果（覆蓋通用 .hidden 類）
				使用transform實現平滑的向上滑出動畫
			*/
			display:block!important;           /* 覆蓋通用.hidden的display:none，確保動畫可見 */
			transform:translateY(-100%);       /* 向上滑出：移動自身高度的100% */
		}
		.reader-controls.hidden{
			/* 
				閱讀器控制欄專用隱藏效果（覆蓋通用 .hidden 類）
				使用transform實現平滑的向下滑出動畫
			*/
			display:flex!important;            /* 覆蓋通用.hidden的display:none，保持flex佈局 */
			transform:translateY(100%);        /* 向下滑出：移動自身高度的100% */
		}
		.page-list .reader-container,
		.page-list .novel-detail,
		.page-list .reader-controls,
		.page-list .settings-modal,
		.page-detail .content-grid,
		.page-detail .reader-container,
		.page-detail .reader-controls,
		.page-detail .settings-modal,
		.page-reader .content-grid,
		.page-reader .novel-detail{
			/* 
				頁面狀態控制
				根據當前頁面類型隱藏不相關的元素
				
				.page-list: 首頁(小說列表)狀態
				.page-detail: 小說詳情頁狀態  
				.page-reader: 閱讀器狀態
				
				這種設計允許單頁面應用(SPA)在不同狀態間切換
				而不需要重新載入頁面
			*/
			display:none;
		}
		footer{
			/* 
				頁腳樣式
				顯示版權信息和免責聲明
			*/
			text-align:center;                 /* 文字居中 */
			padding:var(--sp);                 /* 內邊距 */
			background:var(--bg);              /* 背景顏色 */
		}
		@media (max-width:768px){
			/* 
				響應式設計 - 移動設備樣式
				當螢幕寬度小於或等於768px時應用這些樣式
				主要針對手機和小平板設備進行優化
			*/
			.navbar{
				/* 移動設備導航欄調整 */
				padding:0.8rem;                       /* 減少內邊距 */
			}
			.nav-title{
				/* 移動設備標題字體調整 */
				font-size:1.2rem;                     /* 減小字體大小 */
			}
			.container{
				/* 移動設備主容器 */
				padding:12px;                         /* 減少內邊距 */
			}
			.content-grid{
				/* 
					移動設備內容網格
					改為2列佈局以適應較窄的螢幕
				*/
				grid-template-columns:repeat(2,1fr);  /* 固定2列，等寬分佈 */
				gap:var(--sp);                        /* 調整間距 */
			}
			.content-card{
				/* 移動設備小說卡片 */
				width:165px;                          /* 減小卡片寬度 */
			}
			.content-card img{
				/* 移動設備卡片圖片 */
				width:165px;                          /* 調整圖片寬度 */
				height:235px;                         /* 調整圖片高度 */
			}
			.novel-info{
				/* 
					移動設備小說信息區域
					調整封面和信息的佈局比例
				*/
				grid-template-columns:200px 1fr;      /* 封面200px，信息佔剩餘空間 */
				gap:var(--sp);                        /* 調整間距 */
			}
			.novel-cover{
				/* 移動設備小說封面 */
				max-width:200px;                      /* 最大寬度限制 */
				margin:0 auto;                        /* 水平居中 */
			}
			.novel-title{
				/* 移動設備小說標題 */
				font-size:1.3rem;                     /* 減小字體 */
			}
			.chapter-list{
				/* 
					移動設備章節列表
					調整網格列寬以適應小螢幕
				*/
				grid-template-columns:repeat(auto-fill,minmax(100px,1fr)); /* 最小列寬100px */
			}
			.reader-container{
				/* 
					移動設備閱讀器容器
					移除圓角和陰影以適應全屏閱讀
				*/
				margin:3.5rem 0 5rem;                 /* 調整邊距 */
				border-radius:0;                      /* 移除圓角 */
				box-shadow:none;                      /* 移除陰影 */
				padding:var(--sp);                    /* 調整內邊距 */
			}
			.settings-modal{
				/* 移動設備設定模態框 */
				width:90%;                            /* 寬度佔螢幕90% */
			}
		}
	</style>
	<!-- CSS樣式表結束 -->
</head>
<!-- head標籤結束 -->

<body>
	<!-- 
		body標籤：頁面主體
		包含所有可見的頁面內容
	-->
	<div id="app" :class="'page-'+currentPage">
		<!-- 
			Vue.js應用的根容器
			id="app": Vue實例會掛載到這個元素上
			:class="'page-'+currentPage": Vue動態類綁定
			- 根據currentPage變量的值動態添加CSS類
			- 例如：currentPage='list'時，會添加'page-list'類
			- 這用於控制不同頁面狀態下元素的顯示/隱藏
		-->
		<nav class="navbar" v-show="currentPage!=='reader'">
			<!-- 
				導航欄組件
				v-show="currentPage!=='reader'": Vue條件顯示指令
				- 當不是閱讀器頁面時顯示導航欄
				- 閱讀器頁面使用不同的導航欄樣式
			-->
			<div class="nav-container">
				<!-- 導航欄內容容器 -->
				<div class="nav-left">
					<!-- 導航欄左側區域 -->
					<button v-if="currentPage==='detail'" class="control-btn back-btn" @click="goToHome">
						<!-- 
							返回按鈕
							v-if="currentPage==='detail'": Vue條件渲染指令
							- 只有在詳情頁時顯示返回按鈕
							@click="goToHome": Vue事件監聽器
							- 點擊時執行goToHome方法，返回首頁
						-->
						<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<!-- 
								SVG圖標：向左箭頭
								viewBox: 定義SVG的視圖框
								stroke: 線條顏色(使用currentColor繼承文字顏色)
							-->
							<path d="M19 12H5M12 19l-7-7 7-7"/>
							<!-- path元素定義SVG路徑：箭頭形狀 -->
						</svg>
					</button>
					<a v-if="currentPage!=='detail'" class="nav-title" @click="goToHome">輕小說翻譯</a>
					<!-- 
						網站標題
						v-if="currentPage!=='detail'": 非詳情頁時顯示標題
						@click="goToHome": 點擊標題也可以返回首頁
					-->
				</div>
				<div class="nav-right">
					<!-- 導航欄右側區域 -->
					<div class="dropdown" v-show="currentPage==='list'" @mouseenter="activeDropdown='sort'" @mouseleave="activeDropdown=null">
						<!-- 
							排序下拉菜單容器
							v-show="currentPage==='list'": 只在首頁顯示排序功能
							@mouseenter="activeDropdown='sort'": 滑鼠進入時展開菜單
							@mouseleave="activeDropdown=null": 滑鼠離開時收起菜單
						-->
						<button class="dropdown-toggle" @click="activeDropdown=activeDropdown==='sort'?null:'sort'" :class="{active:activeDropdown==='sort'}">
							<!-- 
								排序選擇器按鈕
								@click: 點擊事件(移動設備備用)
								:class="{active:activeDropdown==='sort'}": 動態類綁定
								- 當activeDropdown==='sort'時添加active類
							-->
							<span>{{currentSortLabel}}</span>
							<!-- 
								排序文字
								{{currentSortLabel}}: Vue文本插值
								- 顯示當前選中的排序方式
							-->
						</button>
						<div class="dropdown-menu" :class="{show:activeDropdown==='sort'}" :style="getDropdownPosition()">
							<!-- 
								下拉菜單
								:class="{show:activeDropdown==='sort'}": 控制顯示/隱藏
								:style="getDropdownPosition()": 動態定位
							-->
							<a v-for="option in sortOptions" :key="option.value" @click="handleSortChange(option)">{{option.label}}</a>
							<!-- 
								排序選項
								v-for="option in sortOptions": Vue列表渲染
								:key="option.value": 為每個項目提供唯一鍵值
								@click="handleSortChange(option)": 處理選項變更
							-->
						</div>
					</div>
					<button class="theme-toggle" @click="toggleTheme">{{isDarkMode?'🌜':'🌞'}}</button>
					<!-- 
						主題切換按鈕
						@click="toggleTheme": 切換明暗主題
						{{isDarkMode?'🌜':'🌞'}}: 條件表達式
						- 根據當前主題顯示不同的emoji圖標
					-->
				</div>
			</div>
		</nav>
		<!-- 導航欄結束 -->

		<div class="container" v-show="currentPage==='list'">
			<!-- 
				首頁容器 - 小說列表頁面
				v-show="currentPage==='list'": 只在首頁狀態時顯示
			-->
			<div class="content-grid">
				<!-- 
					內容網格容器
					使用CSS Grid佈局創建響應式的卡片網格
				-->
				<div v-for="item in sortedNovelList" :key="item.title" class="content-card" @click="goToDetail(item)">
					<!-- 
						小說卡片組件
						v-for="item in sortedNovelList": Vue列表渲染
						- 遍歷已排序的小說列表
						:key="item.title": 為每個卡片提供唯一識別
						@click="goToDetail(item)": 點擊卡片進入小說詳情頁
					-->
					<img :src="item.coverUrl" :alt="item.title">
					<!-- 
						小說封面圖片
						:src="item.coverUrl": Vue屬性綁定，動態設定圖片來源
						:alt="item.title": 設定圖片替代文字(無障礙功能)
					-->
					<div class="content-card-info">
						<!-- 卡片信息區域 -->
						<div class="content-title">{{item.title}}</div>
						<!-- 
							小說標題
							{{item.title}}: Vue文本插值，顯示小說標題
						-->
						<div class="card-footer">
							<!-- 卡片底部信息區域 -->
							<span>{{item.author}}</span>
							<!-- 
								作者名稱
								{{item.author}}: 顯示小說作者
							-->
							<span>{{new Date(item.lastUpdated).toLocaleDateString()}}</span>
							<!-- 
								更新時間
								{{new Date(item.lastUpdated).toLocaleDateString()}}: 
								- 將時間戳轉換為Date對象
								- 使用toLocaleDateString()格式化為本地日期格式
							-->
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- 首頁容器結束 -->

		<div class="container" v-show="currentPage==='detail'">
			<!-- 
				詳情頁容器 - 小說詳細信息頁面
				v-show="currentPage==='detail'": 只在詳情頁狀態時顯示
			-->
			<div class="novel-detail">
				<!-- 小說詳情主容器 -->
				<div class="novel-info">
					<!-- 
						小說基本信息區域
						使用Grid佈局：左側封面，右側詳細信息
					-->
					<img :src="getCoverUrl()" :alt="selectedNovel?.title" class="novel-cover" @click="openLightbox(getCoverUrl())">
					<!-- 
						小說封面圖片
						:src="getCoverUrl()": 調用方法獲取封面URL
						:alt="selectedNovel?.title": 使用可選鏈操作符安全訪問標題
						@click="openLightbox(getCoverUrl())": 點擊放大查看
					-->
					<div>
						<!-- 小說詳細信息區域 -->
						<h2 class="novel-title">{{selectedNovel?.title}}</h2>
						<!-- 
							小說標題(h2標題標籤)
							{{selectedNovel?.title}}: 使用可選鏈操作符安全顯示標題
						-->
						<div class="novel-metadata">
							<!-- 小說元數據區域 -->
							<p><strong>作者：</strong>{{selectedNovel?.author}}</p>
							<!-- 
								作者信息
								<strong>標籤用於強調重要文字
							-->
							<p><strong>類型：</strong>{{selectedNovel?.genres}}</p>
							<!-- 小說類型/標籤 -->
							<p class="source-links">
								<!-- 原文鏈接區域 -->
								<strong>原連結：</strong>
								<a v-for="(link,key) in selectedNovel?.sourceLinks" :key="key" :href="link" target="_blank" class="source-link">{{getSourceLinkName(key)}}</a>
								<!-- 
									原文網站鏈接
									v-for="(link,key) in selectedNovel?.sourceLinks": 遍歷鏈接對象
									:key="key": 使用鏈接類型作為鍵值
									:href="link": 動態設定鏈接地址
									target="_blank": 在新視窗中開啟鏈接
								-->
							</p>
						</div>
						<div class="novel-description" v-html="parsedDescription"></div>
						<!-- 
							小說描述/簡介
							v-html="parsedDescription": Vue HTML綁定
							- 將Markdown格式的描述渲染為HTML
							- 注意：v-html會直接插入HTML，需確保內容安全
						-->
					</div>
				</div>
				<div class="chapter-list">
					<!-- 
						章節列表容器
						使用Grid佈局創建響應式的章節卡片網格
					-->
					<div v-for="chapter in chaptersWithDates" :key="chapter.number" class="chapter-item" :class="{read:isChapterRead(chapter.number)}" @click="goToChapter(chapter.number)">
						<!-- 
							章節項目
							v-for="chapter in chaptersWithDates": 遍歷章節列表
							:key="chapter.number": 使用章節號作為唯一鍵值
							:class="{read:isChapterRead(chapter.number)}": 動態類綁定
							- 如果章節已讀，添加read類改變樣式
							@click="goToChapter(chapter.number)": 點擊進入閱讀
						-->
						<div class="chapter-title">{{chapter.title}}</div>
						<!-- 章節標題 -->
						<div class="chapter-date">{{formatDate(chapter.date)}}</div>
						<!-- 
							章節日期
							{{formatDate(chapter.date)}}: 調用格式化日期方法
						-->
					</div>
				</div>
			</div>
		</div>
		<!-- 詳情頁容器結束 -->

		<div v-show="currentPage==='reader'">
			<!-- 
				閱讀器頁面容器
				v-show="currentPage==='reader'": 只在閱讀器狀態時顯示
				提供沉浸式的小說閱讀體驗
			-->
			<div class="navbar" :class="{hidden:hideControls}">
				<!-- 
					閱讀器導航欄
					:class="{hidden:hideControls}": 根據hideControls變量控制顯示/隱藏
					- 向下滾動時自動隱藏，提供更好的閱讀體驗
				-->
				<div class="nav-container">
					<!-- 閱讀器導航容器 -->
					<button class="control-btn back-btn" @click="goBackToDetail">
						<!-- 
							返回詳情頁按鈕
							@click="goBackToDetail": 返回小說詳情頁
						-->
						<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<!-- 返回箭頭圖標 -->
							<path d="M19 12H5M12 19l-7-7 7-7"/>
						</svg>
					</button>
					<div class="reader-title">{{currentChapter?.title}}</div>
					<!-- 
						當前章節標題
						{{currentChapter?.title}}: 顯示正在閱讀的章節標題
						使用可選鏈操作符防止undefined錯誤
					-->
				</div>
			</div>
			<div class="reader-container">
				<!-- 
					閱讀器內容容器
					專為閱讀體驗優化的佈局和樣式
				-->
				<div class="novel-content" v-html="parsedContent"></div>
				<!-- 
					小說正文內容
					v-html="parsedContent": 將Markdown格式的章節內容渲染為HTML
					- parsedContent是通過marked.js解析的HTML內容
					- 支持富文本格式（粗體、斜體、圖片、鏈接等）
				-->
			</div>
			<div class="reader-controls" :class="{hidden:hideControls}">
				<!-- 
					閱讀器控制欄
					固定在頁面底部，提供章節導航和設定功能
					:class="{hidden:hideControls}": 與導航欄同步顯示/隱藏
				-->
				<button class="control-btn" @click="goToPrevious" :disabled="!hasPrevious||isLoading">上一話</button>
				<!-- 
					上一章按鈕
					@click="goToPrevious": 跳轉到上一章節
					:disabled="!hasPrevious||isLoading": 動態禁用狀態
					- !hasPrevious: 如果沒有上一章則禁用
					- isLoading: 載入期間禁用防止重複操作
				-->
				<button class="control-btn" @click="toggleChapterMenu" :disabled="isLoading">目錄</button>
				<!-- 
					章節目錄按鈕
					@click="toggleChapterMenu": 顯示/隱藏章節目錄
				-->
				<button class="control-btn" @click="toggleSettings" :disabled="isLoading">設置</button>
				<!-- 
					設定按鈕
					@click="toggleSettings": 顯示/隱藏閱讀設定
					- 包含字體大小、行距、夜間模式等選項
				-->
				<button class="control-btn" @click="goToNext" :disabled="!hasNext||isLoading">下一話</button>
				<!-- 
					下一章按鈕
					@click="goToNext": 跳轉到下一章節
					:disabled="!hasNext||isLoading": 動態禁用狀態
				-->
			</div>
			<!-- 閱讀器控制欄結束 -->
			<div class="settings-modal" :class="{active:showSettings||showChapterMenu}">
				<!-- 
					設定模態框
					從底部滑入的彈窗，用於顯示閱讀設定或章節目錄
					:class="{active:showSettings||showChapterMenu}": 動態控制顯示
					- 當任一設定面板開啟時，模態框會從底部滑入
				-->
				<div class="settings-modal-header">{{showSettings?'閱讀設置':'章節目錄'}}</div>
				<!-- 
					模態框標題
					{{showSettings?'閱讀設置':'章節目錄'}}: 條件表達式
					- 根據當前顯示的內容動態改變標題
				-->
				<div class="settings-group" v-if="showSettings">
					<!-- 
						閱讀設定區域
						v-if="showSettings": 只有在顯示設定時才渲染這個區域
					-->
					<label>字體大小: {{fontSize}}px</label>
					<!-- 
						字體大小標籤
						{{fontSize}}px: 顯示當前字體大小數值
					-->
					<input type="range" v-model="fontSize" min="14" max="24" step="1">
					<!-- 
						字體大小滑桿
						type="range": HTML5範圍輸入控件
						v-model="fontSize": Vue雙向數據綁定
						- 滑桿變化會即時更新fontSize變量
						- fontSize變化也會更新滑桿位置
					-->
					<label>行距: {{lineHeight}}</label>
					<!-- 行距標籤和當前數值 -->
					<input type="range" v-model="lineHeight" min="1.5" max="2.5" step="0.1">
					<!-- 
						行距滑桿
						v-model="lineHeight": 雙向綁定行距值
					-->
					<label><input type="checkbox" v-model="isDarkMode">夜間模式</label>
					<!-- 
						夜間模式開關
						type="checkbox": HTML複選框輸入
						v-model="isDarkMode": 雙向綁定夜間模式狀態
					-->
				</div>
				<div class="settings-group" v-if="showChapterMenu">
					<!-- 
						章節目錄區域
						v-if="showChapterMenu": 只有在顯示章節目錄時才渲染
					-->
					<div v-for="chapter in allChapters" :key="chapter.number" class="chapter-item" :class="{current:chapter.number===currentChapter?.number,read:isChapterRead(chapter.number)}" @click="goToChapterInReader(chapter.number)">
						<!-- 
							章節目錄項目
							v-for="chapter in allChapters": 遍歷所有章節
							:key="chapter.number": 使用章節號作為唯一鍵值
							:class="{...}": 動態類綁定對象語法
							- current: 當前正在閱讀的章節
							- read: 已讀過的章節
							@click="goToChapterInReader(chapter.number)": 點擊跳轉章節
						-->
						<div>{{chapter.title}}</div>
						<!-- 章節標題 -->
					</div>
				</div>
			</div>
		</div>
		<!-- 閱讀器頁面容器結束 -->

		<div class="lightbox" :class="{active:isLightboxActive}" @click="closeLightbox">
			<!-- 
				燈箱圖片查看器
				用於全屏顯示圖片，提供更好的圖片查看體驗
				:class="{active:isLightboxActive}": 根據狀態控制顯示/隱藏
				@click="closeLightbox": 點擊背景關閉燈箱
			-->
			<div class="lightbox-content">
				<!-- 
					燈箱內容容器
					包含圖片和關閉按鈕
				-->
				<button class="close-lightbox" @click.stop="closeLightbox">✕</button>
				<!-- 
					關閉按鈕
					@click.stop="closeLightbox": 
					- .stop修飾符阻止事件冒泡
					- 防止點擊關閉按鈕時觸發背景的點擊事件
				-->
				<img :src="lightboxImage" alt="" @click.stop>
				<!-- 
					燈箱圖片
					:src="lightboxImage": 綁定要顯示的圖片URL
					@click.stop: 阻止點擊圖片時關閉燈箱
				-->
			</div>
		</div>

		<div class="loading-overlay" :class="{show:isLoading}">
			<!-- 
				載入遮罩層
				在載入內容時顯示，提供視覺反饋
				:class="{show:isLoading}": 根據載入狀態控制顯示
			-->
			<div style="text-align:center;">
				<!-- 載入內容容器，使用內聯樣式居中對齊 -->
				<div class="loading-spinner"></div>
				<!-- 
					載入旋轉器
					純CSS實現的旋轉動畫，表示正在載入
				-->
				<div class="loading-text">載入中...</div>
				<!-- 載入提示文字 -->
			</div>
		</div>

		<footer v-show="currentPage!=='reader'">
			<!-- 
				網站頁腳
				v-show="currentPage!=='reader'": 
				- 除了閱讀器頁面外都顯示頁腳
				- 閱讀器頁面隱藏頁腳以提供更好的閱讀體驗
			-->
			<p style="font-size:0.8em;margin-top:1em;">此網站僅供學習和參考使用，所有內容版權歸原作者所有。</p>
			<!-- 
				免責聲明
				使用內聯樣式設定較小字體和上邊距
				說明網站用途和版權歸屬
			-->
		</footer>
	</div>
	<!-- Vue.js應用根容器結束 -->

	<script>
		/* 
			JavaScript應用邏輯開始
			
			此部分包含完整的Vue.js應用代碼
			實現小說閱讀器的所有功能：
			- 小說列表顯示和排序
			- 小說詳情頁面
			- 章節閱讀器
			- 用戶設定管理
			- 本地存儲管理
			- URL路由管理
			
			緊湊格式：移除運算符和符號周圍的空格以減少文件大小
		*/
		const {createApp}=Vue;
		/* 
			從Vue全局對象中解構createApp函數
			createApp是Vue 3的應用工廠函數，用於創建Vue應用實例
		*/
		const STORAGE_KEYS={
			/* 
				本地存儲鍵值常量對象
				統一管理所有localStorage和sessionStorage的鍵名
				避免鍵名錯誤和重複定義
			*/
			THEME:'theme',                           // 主題設定(明暗模式)
			SORT:'content_sort',                     // 排序方式
			FONT_SIZE:'font_size',                   // 字體大小設定
			LINE_HEIGHT:'line_height',               // 行距設定
			SCROLL_POSITION:'novel_scroll_position', // 閱讀位置記錄
			READ_CHAPTERS:'read_chapters',           // 已讀章節記錄
			CURRENT_NOVEL:'currentNovel'             // 當前選中的小說
		};
		createApp({
			/* 
				創建Vue 3應用實例
				包含應用的完整配置：data、computed、watch、methods等
			*/
			data(){
				/* 
					data函數：定義組件的響應式數據
					返回一個包含所有狀態變量的對象
					這些數據的任何變化都會觸發視圖更新
				*/
				return{
					/* 頁面狀態管理 */
					currentPage:'list',              // 當前頁面狀態：'list'(首頁)、'detail'(詳情頁)、'reader'(閱讀器)
					/* 數據狀態 */
					novelList:[],                    // 小說列表數組，從novels.json載入
					selectedNovel:null,              // 當前選中的小說對象
					selectedNovelData:null,          // 選中小說的原始數據
					allChapters:[],                  // 當前小說的所有章節列表
					currentChapter:null,             // 正在閱讀的章節對象
					chapterContent:'',               // 當前章節的Markdown內容
					/* 用戶設定 - 從localStorage載入或使用默認值 */
					isDarkMode:localStorage.getItem(STORAGE_KEYS.THEME)==='dark',  // 夜間模式開關
					fontSize:parseInt(localStorage.getItem(STORAGE_KEYS.FONT_SIZE))||18,      // 閱讀字體大小
					lineHeight:parseFloat(localStorage.getItem(STORAGE_KEYS.LINE_HEIGHT))||1.8, // 閱讀行距
					currentSort:localStorage.getItem(STORAGE_KEYS.SORT)||'lastUpdated',        // 當前排序方式
					/* 排序選項配置 */
					sortOptions:[
						{value:'lastUpdated',label:'最新更新'}, // 按最後更新時間排序
						{value:'chapterCount',label:'章節數'},  // 按章節數量排序
						{value:'wordCount',label:'文字數'}      // 按總字數排序
					],
					/* UI狀態控制 */
					activeDropdown:null,             // 當前活動的下拉菜單：null、'sort'
					isLoading:false,                 // 是否正在載入內容
					hideControls:false,              // 是否隱藏閱讀器控制欄
					showSettings:false,              // 是否顯示閱讀設定
					showChapterMenu:false,           // 是否顯示章節目錄
					isLightboxActive:false,          // 是否顯示圖片燈箱
					lightboxImage:'',                // 燈箱中顯示的圖片URL
					lastScrollTop:0                  // 上次滾動位置，用於判斷滾動方向
				}
			},
			computed:{
				/* 
					computed計算屬性：基於響應式數據計算得出的值
					特點：
					1. 基於依賴的響應式數據自動更新
					2. 具有緩存機制，只有依賴變化時才重新計算
					3. 在模板中可以像data屬性一樣使用
				*/
				currentSortLabel(){
					/* 
						獲取當前排序方式的顯示標籤
						根據currentSort值查找對應的標籤文字
					*/
					return this.sortOptions.find(opt=>opt.value===this.currentSort)?.label||'排序';
				},
				sortedNovelList(){
					/* 
						排序後的小說列表
						根據用戶選擇的排序方式對小說列表進行排序
						使用展開運算符[...array]創建新數組，避免修改原數組
					*/
					return[...this.novelList].sort((a,b)=>{
						switch(this.currentSort){
							case'lastUpdated':
								// 按最後更新時間降序排列（最新的在前）
								return new Date(b.lastUpdated)-new Date(a.lastUpdated);
							case'chapterCount':
								// 按章節數量降序排列（章節多的在前）
								return(b.chapters||[]).length-(a.chapters||[]).length;
							case'wordCount':
								// 按總字數降序排列（字數多的在前）
								return(b.totalWordCount||0)-(a.totalWordCount||0);
							default:
								return 0; // 默認不排序
						}
					});
				},
				chaptersWithDates(){
					/* 
						帶日期的章節列表
						按章節號降序排列（最新章節在前）
					*/
					return this.allChapters.sort((a,b)=>b.number-a.number);
				},
				parsedDescription(){
					/* 
						解析後的小說描述
						使用marked.js將Markdown格式轉換為HTML
						使用可選鏈操作符(?.)安全訪問屬性
					*/
					return this.selectedNovel?.description?marked.parse(this.selectedNovel.description):'';
				},
				parsedContent(){
					/* 
						解析後的章節內容
						將Markdown格式的章節內容轉換為HTML用於顯示
					*/
					return this.chapterContent?marked.parse(this.chapterContent):'';
				},
				hasNext(){
					/* 
						是否有下一章
						檢查是否存在章節號大於當前章節的章節
					*/
					return this.allChapters.some(chapter=>chapter.number>this.currentChapter?.number);
				},
				hasPrevious(){
					/* 
						是否有上一章
						檢查是否存在章節號小於當前章節的章節
					*/
					return this.allChapters.some(chapter=>chapter.number<this.currentChapter?.number);
				}
			},
			watch:{
				/* 
					watch監聽器：監聽響應式數據的變化並執行相應操作
					特點：
					1. 當被監聽的數據發生變化時自動觸發
					2. 可以執行異步操作
					3. 適合處理數據變化的副作用
				*/
				isDarkMode(newValue){
					/* 
						監聽夜間模式切換
						當isDarkMode變化時：
						1. 更新文檔的data-theme屬性以切換CSS主題
						2. 保存設定到localStorage
					*/
					const theme=newValue?'dark':'light';  // 根據布爾值確定主題字符串
					document.documentElement.setAttribute('data-theme',theme);  // 設定根元素的主題屬性
					localStorage.setItem(STORAGE_KEYS.THEME,theme);  // 持久化保存主題設定
				},
				fontSize(newValue){
					/* 
						監聽字體大小變化
						當fontSize變化時：
						1. 即時更新CSS變量以改變字體大小
						2. 保存設定到localStorage
					*/
					document.documentElement.style.setProperty('--fs',`${newValue}px`);  // 更新CSS變量
					localStorage.setItem(STORAGE_KEYS.FONT_SIZE,newValue);  // 持久化保存字體設定
				},
				lineHeight(newValue){
					/* 
						監聽行距變化
						當lineHeight變化時：
						1. 即時更新CSS變量以改變行距
						2. 保存設定到localStorage
					*/
					document.documentElement.style.setProperty('--lh',newValue);  // 更新CSS變量
					localStorage.setItem(STORAGE_KEYS.LINE_HEIGHT,newValue);  // 持久化保存行距設定
				},
				currentPage(newValue){
					/* 
						監聽頁面狀態變化
						當進入/離開閱讀器頁面時：
						1. 進入閱讀器：添加滾動監聽和圖片查看器
						2. 離開閱讀器：移除滾動監聽，避免內存洩漏
					*/
					if(newValue==='reader'){
						// 進入閱讀器頁面
						this.$nextTick(()=>{
							/* 
								$nextTick：等待DOM更新完成後執行
								確保閱讀器元素已經渲染到頁面上
							*/
							window.addEventListener('scroll',this.handleScroll);  // 添加滾動監聽
							this.setupImageViewer();  // 設置圖片點擊放大功能
						});
					}else{
						// 離開閱讀器頁面
						window.removeEventListener('scroll',this.handleScroll);  // 移除滾動監聽
					}
				}
			},
			methods:{
				/* 
					methods方法：定義組件的行為和操作
					包含所有業務邏輯、事件處理、API調用等功能
				*/
				async fetchNovelList(){
					/* 
						獲取小說列表數據
						從novels.json文件載入所有小說的基本信息
						這是應用啟動時的核心數據載入方法
					*/
					try{
						// 使用fetch API發送HTTP請求獲取小說列表
						const response=await fetch('輕小說翻譯/novels.json');
						const data=await response.json();
						// 處理和格式化小說數據
						this.novelList=data.novels.map(novel=>{
							/* 
								標準化小說標題格式
								確保所有標題都有書名號《》包圍
							*/
							const titleWithBrackets=novel.title.startsWith('《')?novel.title:`《${novel.title}》`;
							return{
								title:titleWithBrackets,  // 標準化的標題
								// 生成封面圖片URL，使用encodeURIComponent編碼避免特殊字符問題
								coverUrl:`輕小說翻譯/${encodeURIComponent(titleWithBrackets)}/cover.jpg`,
								lastUpdated:novel.lastUpdated||new Date().toISOString(),  // 最後更新時間
								author:novel.author||'未知作者',  // 作者信息
								chapters:novel.chapters||[],  // 章節列表
								totalWordCount:novel.totalWordCount||0,  // 總字數
								originalData:novel  // 保留原始數據供詳情頁使用
							};
						});
					}catch(error){
						// 錯誤處理：記錄到控制台
						console.error('讀取小說列表失敗:',error);
					}
				},
				updateUrl(page,params={}){
					/* 
						更新瀏覽器URL
						實現單頁面應用(SPA)的URL路由功能
						支持瀏覽器的前進/後退按鈕和書籤功能
					*/
					let url=window.location.pathname;  // 獲取當前路徑
					const searchParams=new URLSearchParams();  // 創建URL參數對象
					// 根據頁面類型設置URL參數
					if(page==='detail'&&params.title)searchParams.set('title',params.title);
					else if(page==='reader'&&params.title&&params.chapter){
						searchParams.set('title',params.title);
						searchParams.set('chapter',params.chapter.toString());
					}
					// 構建完整URL
					const queryString=searchParams.toString();
					const newUrl=queryString?`${url}?${queryString}`:url;
					// 使用History API更新URL（不刷新頁面）
					window.history.pushState({page,params},'',newUrl);
					// 同時更新頁面標題
					this.updatePageTitle(page,params);
				},
				updatePageTitle(page,params={}){
					/* 
						更新瀏覽器標籤頁標題
						根據當前頁面和內容動態設定標題
						提升用戶體驗和SEO效果
					*/
					let title='輕小說翻譯';  // 默認標題
					if(page==='detail'&&params.title)title=`${params.title} - 輕小說翻譯`;
					else if(page==='reader'&&params.title&&this.currentChapter)title=`${this.currentChapter.title} - ${params.title} - 輕小說翻譯`;
					document.title=title;  // 設定文檔標題
				},
				async handleUrlParams(){
					/* 
						處理URL參數並相應地設定應用狀態
						實現深層鏈接功能，讓用戶可以直接訪問特定頁面
						支持分享具體章節的鏈接
					*/
					const urlParams=new URLSearchParams(window.location.search);  // 解析URL查詢參數
					const titleParam=urlParams.get('title');      // 獲取小說標題參數
					const chapterParam=urlParams.get('chapter');  // 獲取章節參數
					if(titleParam){
						// 如果URL包含小說標題參數
						if(this.novelList.length===0)await this.fetchNovelList();
						// 根據標題查找對應的小說
						const novel=this.novelList.find(n=>n.title===titleParam);
						if(novel){
							// 找到對應小說，設定選中狀態
							this.selectedNovel=novel;
							this.selectedNovelData=novel.originalData;
							this.setupNovelDetail();  // 設置小說詳情
							localStorage.setItem(STORAGE_KEYS.CURRENT_NOVEL,titleParam);  // 記住當前小說
							if(chapterParam){
								// 如果還有章節參數，嘗試直接進入閱讀器
								const chapterNumber=parseFloat(chapterParam);
								this.currentChapter=this.allChapters.find(ch=>ch.number===chapterNumber);
								if(this.currentChapter){
									this.currentPage='reader';
									await this.loadChapterContent();
								}else{
									this.currentPage='detail';
									this.updateUrl('detail',{title:titleParam});
								}
							}else this.currentPage='detail';
						}else this.goToHome();
					}else this.currentPage='list';
				},
				goToHome(){
					/* 
						返回首頁
						重置所有狀態，清理選中的小說和章節
						更新URL和頁面標題
					*/
					this.currentPage='list';           // 設定頁面狀態為首頁
					this.selectedNovel=null;           // 清除選中的小說
					this.currentChapter=null;          // 清除當前章節
					this.activeDropdown=null;          // 關閉所有下拉菜單
					// 更新瀏覽器歷史記錄，回到乾淨的首頁URL
					window.history.pushState({page:'list'},'輕小說翻譯',window.location.pathname);
					document.title='輕小說翻譯';      // 重置頁面標題
				},
				goToDetail(novel){
					/* 
						進入小說詳情頁
						設定選中的小說，載入詳情信息和章節列表
						更新URL以支持直接訪問
					*/
					this.selectedNovel=novel;                    // 設定選中的小說
					this.selectedNovelData=novel.originalData;   // 保存原始數據供詳情頁使用
					this.setupNovelDetail();                      // 設置詳情頁數據
					this.currentPage='detail';                  // 切換到詳情頁
					this.activeDropdown=null;                   // 關閉下拉菜單
					// 記住當前選中的小說到localStorage
					localStorage.setItem(STORAGE_KEYS.CURRENT_NOVEL,novel.title);
					// 更新URL，支持書籤和分享
					this.updateUrl('detail',{title:novel.title});
				},
				goToChapter(chapterNumber){
					/* 
						從詳情頁進入指定章節的閱讀器
						設定當前章節並載入內容
					*/
					this.currentChapter=this.allChapters.find(ch=>ch.number===chapterNumber);  // 找到對應章節
					this.loadChapterContent();                      // 載入章節內容
					this.currentPage='reader';                    // 切換到閱讀器頁面
					this.showChapterMenu=false;                   // 關閉章節目錄
					// 更新URL以支持直接訪問此章節
					this.updateUrl('reader',{title:this.selectedNovel.title,chapter:chapterNumber});
				},
				goToChapterInReader(chapterNumber){
					/* 
						在閱讀器內跳轉到指定章節
						包含防重複載入檢查和滾動位置保存
					*/
					if(chapterNumber!==this.currentChapter?.number&&!this.isLoading){
						// 只有在章節不同且未在載入中時才執行跳轉
						this.saveScrollPosition();                  // 保存當前章節的閱讀位置
						this.currentChapter=this.allChapters.find(ch=>ch.number===chapterNumber);  // 設定新章節
						this.loadChapterContent();                  // 載入新章節內容
						// 更新URL
						this.updateUrl('reader',{title:this.selectedNovel.title,chapter:chapterNumber});
					}
					this.showChapterMenu=false;                   // 關閉章節目錄
				},
				goBackToDetail(){
					/* 
						從閱讀器返回到小說詳情頁
						重置閱讀器相關的UI狀態
					*/
					this.currentPage='detail';                    // 切換到詳情頁
					this.hideControls=false;                      // 顯示控制欄（重置隱藏狀態）
					this.showSettings=false;                      // 關閉設定面板
					this.showChapterMenu=false;                   // 關閉章節目錄
					// 更新URL
					this.updateUrl('detail',{title:this.selectedNovel.title});
				},
				setupNovelDetail(){
					/* 
						設置小說詳情頁的數據
						處理原始數據，格式化為詳情頁所需的結構
						包括原文鏈接整理和章節列表處理
					*/
					if(!this.selectedNovelData)return;  // 如果沒有原始數據則退出
					// 整理原文鏈接
					const sourceLinks={};
					if(this.selectedNovelData.originalUrl){
						// 將多個URL按「、」分割
						const urls=this.selectedNovelData.originalUrl.split('、');
						urls.forEach(url=>{
							// 根據域名分類鏈接
							if(url.includes('kakuyomu.jp'))sourceLinks.kakuyomu=url;         // カクヨム網站
							else if(url.includes('syosetu.com'))sourceLinks.syosetu=url;          // 小説家になろう網站
							else sourceLinks.japanese=url;         // 其他日文原文網站
						});
					}
					// 擴展選中小說的數據結構
					this.selectedNovel={
						...this.selectedNovel,                      // 保留現有屬性
						genres:this.selectedNovelData.tags?.join(', ')||'',    // 將標籤陣列轉為字符串
						description:this.selectedNovelData.description||'',    // 小說描述
						sourceLinks:sourceLinks                    // 整理後的原文鏈接
					};
					// 處理章節列表
					this.allChapters=this.selectedNovelData.chapters
						.filter(chapter=>chapter.id>=0)        // 過濾掉無效章節（id<0）
						.map(chapter=>({
							number:chapter.id,                     // 章節號
							title:chapter.title,                   // 章節標題
							// 生成檔案名：移除「第X話」前綴，避免檔案名過長
							filename:`${chapter.id} ${chapter.title.replace(/^第\d+\.?\d*話\s+/,'')}.md`,
							// 格式化日期為YYYY-MM-DD格式
							date:new Date(chapter.lastUpdated).toISOString().split('T')[0]
						}))
						.sort((a,b)=>a.number-b.number);       // 按章節號升序排列
				},
				getCoverUrl(){
					/* 
						獲取當前選中小說的封面圖片URL
						使用encodeURIComponent確保特殊字符被正確編碼
					*/
					return this.selectedNovel?`輕小說翻譯/${encodeURIComponent(this.selectedNovel.title)}/cover.jpg`:'';
				},
				getSourceLinkName(key){
					/* 
						獲取原文鏈接的友好顯示名稱
						將鏈接類型轉換為可讀的網站名稱
					*/
					const names={kakuyomu:'カクヨム',syosetu:'小説家になろう',japanese:'日文原文'};
					return names[key]||key;             // 如果找不到對應名稱則返回原鍵值
				},
				formatDate(dateStr){
					/* 
						格式化日期字符串為本地化格式
						將ISO日期字符串轉換為YYYY-MM-DD格式
					*/
					if(!dateStr)return'';              // 如果沒有日期則返回空字符串
					const date=new Date(dateStr);
					return date.toLocaleDateString('zh-TW',{year:'numeric',month:'2-digit',day:'2-digit'}).replace(/\//g,'-');
				},
				async loadChapterContent(){
					/* 
						載入章節內容
						從服務器獲取Markdown格式的章節文件
						包含完整的錯誤處理和用戶體驗優化
					*/
					try{
						this.isLoading=true;  // 設定載入狀態，顯示載入動畫
						// 構建章節文件路徑
						const folderPath=encodeURIComponent(this.selectedNovel.title);      // 編碼小說標題
						const encodedFilename=encodeURIComponent(this.currentChapter.filename);  // 編碼檔案名
						const filename=`輕小說翻譯/${folderPath}/${encodedFilename}`;
						// 使用fetch API載入章節文件
						const response=await fetch(filename);
						// 檢查HTTP響應狀態
						if(!response.ok)throw new Error(`HTTP ${response.status}: ${response.statusText}`);
						// 獲取文件內容（Markdown格式）
						this.chapterContent=await response.text();
						// 等待DOM更新後執行後續操作
						this.$nextTick(()=>{
							this.scrollToTop();                    // 滾動到頁面頂部
							this.setupImageViewer();               // 設置圖片點擊放大功能
							this.restoreScrollPosition();          // 恢復之前的閱讀位置
							this.markAsRead();                     // 標記章節為已讀
							this.isLoading=false;                // 關閉載入狀態
							// 更新頁面標題包含章節信息
							this.updatePageTitle('reader',{title:this.selectedNovel.title});
						});
					}catch(error){
						// 錯誤處理
						this.isLoading=false;                    // 關閉載入狀態
						console.error('讀取章節內容失敗:',error);
						// 向用戶顯示友好的錯誤信息
						alert(`讀取章節內容失敗: ${error.message}`);
					}
				},
				setupImageViewer(){
					/* 
						設置圖片查看器功能
						為小說內容中的圖片添加點擊放大功能
						使用事件委托模式處理動態添加的圖片
					*/
					this.$nextTick(()=>{
						/* 
							$nextTick確保DOM已完全更新
							這很重要因為章節內容是動態加載的
						*/
						const content=document.querySelector('.novel-content');  // 獲取小說內容容器
						if(content){
							// 為內容容器添加點擊事件監聽器（事件委托）
							content.addEventListener('click',(e)=>{
								/* 
									事件委托：
									- 在父元素上監聽事件，而不是每個圖片上
									- 好處：節省內存，支持動態添加的元素
									- e.target是實際被點擊的元素
								*/
								if(e.target.tagName==='IMG'){
									// 檢查點擊的是否為圖片元素
									this.lightboxImage=e.target.src;     // 設定燈箱要顯示的圖片URL
									this.isLightboxActive=true;           // 啟動燈箱
									this.showSettings=false;             // 關閉設定面板
									this.showChapterMenu=false;          // 關閉章節目錄
								}
							});
						}
					});
				},
				scrollToTop(){
					/* 
						滾動到頁面頂部
						在載入新章節時自動回到頂部，提供更好的閱讀體驗
					*/
					window.scrollTo(0,0);  // 滾動到座標(0,0)，即頁面左上角
				},
				handleScroll(){
					/* 
						處理頁面滾動事件
						實現智能隱藏控制欄功能：
						- 向下滾動時隱藏控制欄（沉浸式閱讀）
						- 向上滾動或接近底部時顯示控制欄
						同時保存滾動位置以便下次恢復
					*/
					// 獲取當前滾動位置（兼容不同瀏覽器）
					const st=window.pageYOffset||document.documentElement.scrollTop;
					// 判斷滾動方向：當前位置>上次位置=向下滾動
					const isScrollingDown=st>this.lastScrollTop;
					// 判斷是否接近頁面底部（距離底部100px以內）
					const isAtBottom=window.innerHeight+window.pageYOffset>=document.body.offsetHeight-100;
					if(isScrollingDown&&!isAtBottom){
						// 向下滾動且不在底部：隱藏控制欄和菜單
						this.hideControls=true;               // 隱藏控制欄
						this.showSettings=false;             // 關閉設定面板
						this.showChapterMenu=false;          // 關閉章節目錄
					}else this.hideControls=false;             // 顯示控制欄
					this.lastScrollTop=st;                   // 記錄當前位置，供下次比較使用
					this.saveScrollPosition();                 // 保存滾動位置到sessionStorage
				},
				saveScrollPosition(){
					/* 
						保存當前章節的閱讀位置
						使用sessionStorage存儲，瀏覽器關閉後會清除
						數據結構：{"小說名":{"章節號":滾動位置}}
						讓用戶返回時能恢復到之前的閱讀位置
					*/
					// 檢查必要條件：必須有選中的小說和當前章節
					if(!this.selectedNovel||!this.currentChapter)return;
					// 從sessionStorage獲取現有的滾動位置記錄
					const scrollPositions=JSON.parse(sessionStorage.getItem(STORAGE_KEYS.SCROLL_POSITION)||'{}');
					// 生成小說的鍵值：移除書名號《》
					const novelKey=this.selectedNovel.title.replace(/^《|》$/g,'');
					// 如果該小說還沒有記錄，創建空對象
					if(!scrollPositions[novelKey])scrollPositions[novelKey]={};
					// 保存當前章節的滾動位置
					scrollPositions[novelKey][this.currentChapter.number]=window.pageYOffset;
					// 將更新後的數據保存回sessionStorage
					sessionStorage.setItem(STORAGE_KEYS.SCROLL_POSITION,JSON.stringify(scrollPositions));
				},
				restoreScrollPosition(){
					/* 
						恢復之前保存的閱讀位置
						從sessionStorage讀取該章節的滾動位置並自動滾動到該位置
						提供無縫的閱讀體驗
					*/
					// 檢查必要條件：必須有選中的小說和當前章節
					if(!this.selectedNovel||!this.currentChapter)return;
					// 從sessionStorage獲取滾動位置記錄
					const scrollPositions=JSON.parse(sessionStorage.getItem(STORAGE_KEYS.SCROLL_POSITION)||'{}');
					// 生成小說的鍵值：移除書名號《》
					const novelKey=this.selectedNovel.title.replace(/^《|》$/g,'');
					// 獲取該小說的所有章節位置記錄，如果沒有則使用空對象
					const novelPositions=scrollPositions[novelKey]||{};
					// 獲取當前章節的保存位置
					const savedPosition=novelPositions[this.currentChapter.number];
					// 如果有保存的位置，恢復到該位置
					if(savedPosition!==undefined)window.scrollTo(0,parseInt(savedPosition));
				},
				goToNext(){
					/* 
						跳轉到下一章節
						包含完整的安全檢查和狀態管理
						使用陣列方法找到章節號最小的下一章（處理章節號不連續的情況）
					*/
					if(this.hasNext&&!this.isLoading){
						// 檢查有下一章且不在載入中
						this.saveScrollPosition();               // 保存當前章節的閱讀位置
						// 找到所有章節號大於當前章節的章節
						const nextChapters=this.allChapters.filter(chapter=>chapter.number>this.currentChapter.number);
						// 從候選章節中找到章節號最小的（最近的下一章）
						const nextChapter=nextChapters.reduce((min,chapter)=>chapter.number<min.number?chapter:min);
						this.currentChapter=nextChapter;        // 設定新的當前章節
						this.loadChapterContent();               // 載入新章節的內容
						// 更新URL以支持直接訪問和書籤
						this.updateUrl('reader',{title:this.selectedNovel.title,chapter:nextChapter.number});
					}
				},
				goToPrevious(){
					/* 
						跳轉到上一章節
						與goToNext類似，但找章節號最大的上一章
						處理章節號不連續的情況（如1,3,5,7...）
					*/
					if(this.hasPrevious&&!this.isLoading){
						// 檢查有上一章且不在載入中
						this.saveScrollPosition();               // 保存當前章節的閱讀位置
						// 找到所有章節號小於當前章節的章節
						const prevChapters=this.allChapters.filter(chapter=>chapter.number<this.currentChapter.number);
						// 從候選章節中找到章節號最大的（最近的上一章）
						const prevChapter=prevChapters.reduce((max,chapter)=>chapter.number>max.number?chapter:max);
						this.currentChapter=prevChapter;        // 設定新的當前章節
						this.loadChapterContent();               // 載入新章節的內容
						// 更新URL以支持直接訪問和書籤
						this.updateUrl('reader',{title:this.selectedNovel.title,chapter:prevChapter.number});
					}
				},
				toggleTheme(){
					/* 
						切換明暗主題
						簡單的布爾值切換，實際的主題應用由watch監聽器處理
					*/
					this.isDarkMode=!this.isDarkMode;
				},
				toggleSettings(){
					/* 
						切換閱讀設定面板的顯示狀態
						同時確保章節目錄面板關閉（一次只顯示一個面板）
					*/
					this.showSettings=!this.showSettings;      // 切換設定面板狀態
					this.showChapterMenu=false;                // 確保章節目錄關閉
				},
				toggleChapterMenu(){
					/* 
						切換章節目錄面板的顯示狀態
						同時確保閱讀設定面板關閉（一次只顯示一個面板）
					*/
					this.showChapterMenu=!this.showChapterMenu;  // 切換章節目錄狀態
					this.showSettings=false;                     // 確保設定面板關閉
				},
				openLightbox(imageUrl){
					/* 
						開啟圖片燈箱
						全屏顯示圖片，同時阻止背景頁面滾動
					*/
					this.lightboxImage=imageUrl;                // 設定要顯示的圖片
					this.isLightboxActive=true;                 // 啟動燈箱
					document.body.style.overflow='hidden';      // 禁止背景頁面滾動
				},
				closeLightbox(){
					/* 
						關閉圖片燈箱
						恢復頁面的正常滾動功能
					*/
					this.isLightboxActive=false;                // 關閉燈箱
					document.body.style.overflow='';            // 恢復頁面滾動
				},
				handleSortChange(sortOption){
					/* 
						處理排序方式變更
						更新當前排序設定並持久化保存，同時關閉下拉菜單
					*/
					this.currentSort=sortOption.value;          // 更新當前排序方式
					localStorage.setItem(STORAGE_KEYS.SORT,sortOption.value);  // 保存到localStorage
					this.activeDropdown=null;                  // 關閉下拉菜單
				},
				getDropdownPosition(){
					/* 
						計算下拉菜單的動態定位
						根據觸發元素的位置計算菜單應該出現的位置
						使用fixed定位確保菜單不會超出視窗邊界
					*/
					const element=document.querySelector('.dropdown-toggle');  // 獲取排序選擇器元素
					if(!element)return{};                      // 如果元素不存在，返回空對象
					const rect=element.getBoundingClientRect(); // 獲取元素的位置和尺寸信息
					return{
						position:'fixed',                        // 使用固定定位
						top:`${rect.bottom+5}px`,              // 菜單頂部=元素底部+5px間距
						right:`${window.innerWidth-rect.right}px`  // 菜單右側對齊元素右側
					};
				},
				closeDropdowns(e){
					/* 
						關閉下拉菜單的事件處理器
						當用戶點擊下拉菜單外部時自動關閉菜單
						使用closest()方法檢查點擊目標是否在下拉菜單內
					*/
					if(!e.target.closest('.dropdown'))this.activeDropdown=null;
				},
				markAsRead(){
					/* 
						標記當前章節為已讀
						在localStorage中記錄用戶已閱讀的章節
						數據結構：{"小說名":[章節號陣列]}
						用於在詳情頁和目錄中顯示已讀狀態
					*/
					// 檢查必要條件：必須有選中的小說和當前章節
					if(!this.selectedNovel||!this.currentChapter)return;
					// 從localStorage獲取已讀章節記錄
					const readChapters=JSON.parse(localStorage.getItem(STORAGE_KEYS.READ_CHAPTERS)||'{}');
					// 生成小說的鍵值：移除書名號《》
					const novelKey=this.selectedNovel.title.replace(/^《|》$/g,'');
					// 如果該小說還沒有已讀記錄，創建空陣列
					if(!readChapters[novelKey])readChapters[novelKey]=[];
					// 檢查當前章節是否已在已讀列表中
					if(!readChapters[novelKey].includes(this.currentChapter.number)){
						// 如果未讀，添加到已讀列表
						readChapters[novelKey].push(this.currentChapter.number);
						// 保存更新後的已讀記錄到localStorage
						localStorage.setItem(STORAGE_KEYS.READ_CHAPTERS,JSON.stringify(readChapters));
					}
				},
				isChapterRead(chapterNumber){
					/* 
						檢查指定章節是否已讀
						從localStorage讀取已讀記錄並檢查特定章節
						返回boolean: true表示已讀，false表示未讀
					*/
					// 如果沒有選中小說，返回false
					if(!this.selectedNovel)return false;
					// 從localStorage獲取已讀章節記錄
					const readChapters=JSON.parse(localStorage.getItem(STORAGE_KEYS.READ_CHAPTERS)||'{}');
					// 生成小說的鍵值：移除書名號《》
					const novelKey=this.selectedNovel.title.replace(/^《|》$/g,'');
					// 使用可選鏈操作符(?.)安全檢查陣列是否包含指定章節號
					return readChapters[novelKey]?.includes(chapterNumber);
				}
			},
			mounted(){
				/* 
					Vue生命週期鉤子：mounted
					在Vue實例掛載到DOM後執行，此時可以訪問DOM元素
					適合進行DOM操作、事件監聽器添加、第三方庫初始化等
				*/
				// 初始化主題設定
				const theme=localStorage.getItem(STORAGE_KEYS.THEME)||'light';  // 獲取保存的主題或使用默認值
				document.documentElement.setAttribute('data-theme',theme);          // 設定根元素的主題屬性
				// 應用保存的字體和行距設定到CSS變量
				document.documentElement.style.setProperty('--fs',`${this.fontSize}px`);
				document.documentElement.style.setProperty('--lh',this.lineHeight);
				// 載入小說列表並處理URL參數
				this.fetchNovelList().then(()=>this.handleUrlParams());
				// 添加瀏覽器前進/後退按鈕支持
				window.addEventListener('popstate',()=>this.handleUrlParams());
				// 添加全局點擊事件監聽器，用於關閉下拉菜單
				document.addEventListener('click',this.closeDropdowns);
				// 添加鍵盤快捷鍵支持
				document.addEventListener('keydown',(e)=>{
					/* 
						ESC鍵功能：
						- 如果燈箱開啟，關閉燈箱
						- 如果在閱讀器頁面，關閉設定和目錄面板
					*/
					if(e.key==='Escape'){
						if(this.isLightboxActive)this.closeLightbox();
						else if(this.currentPage==='reader'){
							this.showSettings=false;
							this.showChapterMenu=false;
						}
					}
				});
				// 添加方向鍵導航支持（僅在閱讀器頁面）
				document.addEventListener('keydown',(e)=>{
					/* 
						方向鍵章節導航：
						- 左箭頭/上箭頭：上一章
						- 右箭頭/下箭頭：下一章
						- 只有在閱讀器頁面且沒有面板開啟時才生效
					*/
					if(this.currentPage==='reader'&&!this.showSettings&&!this.showChapterMenu&&!this.isLightboxActive){
						if((e.key==='ArrowLeft'||e.key==='ArrowUp')&&this.hasPrevious)this.goToPrevious();
						else if((e.key==='ArrowRight'||e.key==='ArrowDown')&&this.hasNext)this.goToNext();
					}
				});
				// 添加閱讀器頁面的點擊外部關閉面板功能
				document.addEventListener('click',(e)=>{
					/* 
						點擊外部關閉面板：
						- 在閱讀器頁面，點擊設定面板和控制按鈕外的區域
						- 自動關閉設定和章節目錄面板
					*/
					if(this.currentPage==='reader'){
						const settingsModal=e.target.closest('.settings-modal');  // 檢查是否點擊設定面板
						const controlBtn=e.target.closest('.control-btn');        // 檢查是否點擊控制按鈕
						if(!settingsModal&&!controlBtn){
							// 如果都不是，關閉面板
							this.showSettings=false;
							this.showChapterMenu=false;
						}
					}
				});
			}
		}).mount('#app');
		/* 
			將Vue應用實例掛載到DOM元素上
			.mount('#app'): 將應用掛載到id為"app"的元素上
			這是Vue應用啟動的最後一步
		*/
	</script>
	<!-- JavaScript應用邏輯結束 -->
</body>
<!-- body標籤結束 -->
</html>
<!-- HTML文檔結束 -->
