<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python 物件導向程式設計期末考總複習</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --bg-color: #ecf0f1;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --border-color: #bdc3c7;
            --code-bg: #f8f9fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
        }

        .sidebar {
            width: 280px;
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(10px);
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 1000;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
        }

        .sidebar.hidden {
            transform: translateX(-100%);
        }

        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }

        .sidebar-header h2 {
            margin: 0;
            font-size: 1.3rem;
            color: #3498db;
        }

        .sidebar-nav {
            padding: 20px 0;
        }

        .nav-item {
            margin: 5px 15px;
        }

        .nav-btn {
            display: block;
            width: 100%;
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
            text-align: left;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: rgba(52, 152, 219, 0.2);
            color: white;
            border-color: #3498db;
            transform: translateX(5px);
        }

        .nav-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .nav-btn i {
            margin-right: 10px;
            width: 20px;
        }

        .progress-section {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
        }

        .progress-title {
            font-size: 0.9rem;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
        }

        .stats-mini {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .stat-mini {
            text-align: center;
            flex: 1;
        }

        .stat-mini .number {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3498db;
        }

        .stat-mini .label {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .main-content {
            flex: 1;
            margin-left: 280px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .mobile-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            color: var(--secondary-color);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: var(--border-color);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color), var(--success-color));
            transition: width 0.3s ease;
            width: 0%;
        }


        .section {
            background: rgba(255, 255, 255, 0.95);
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-header {
            background: var(--primary-color);
            color: white;
            padding: 25px;
            font-size: 1.8rem;
            font-weight: bold;
        }

        .section-content {
            padding: 30px;
        }

        .concept-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        .concept-title {
            color: var(--secondary-color);
            font-size: 1.5rem;
            margin-bottom: 15px;
            font-weight: bold;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
        }

        .concept-description {
            font-size: 1.1rem;
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .key-points {
            background: var(--code-bg);
            border-left: 4px solid var(--warning-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .key-points h4 {
            color: var(--warning-color);
            margin-bottom: 10px;
        }

        .code-container {
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
        }

        .code-header {
            background: var(--primary-color);
            color: white;
            padding: 10px 15px;
            font-size: 0.9rem;
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .code-content {
            padding: 0;
        }

        .code-editor {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            border: none;
            outline: none;
            resize: vertical;
            background: var(--code-bg);
            color: var(--text-color);
        }

        .run-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .run-btn:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }

        .quiz-container {
            background: var(--code-bg);
            border: 2px solid var(--secondary-color);
            border-radius: 10px;
            padding: 25px;
            margin: 30px 0;
        }

        .quiz-header {
            color: var(--secondary-color);
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .question {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: white;
        }

        .question-text {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .options {
            list-style: none;
        }

        .option {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: var(--bg-color);
        }

        .option.selected {
            background: var(--secondary-color);
            color: white;
        }

        .option.correct {
            background: var(--success-color);
            color: white;
        }

        .option.incorrect {
            background: var(--accent-color);
            color: white;
        }

        .submit-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: var(--primary-color);
        }

        .score-display {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background: var(--success-color);
            color: white;
        }

        .explanation {
            background: #e8f5e8;
            border-left: 4px solid var(--success-color);
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
        }

        .memory-tip {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .memory-tip h4 {
            color: #d35400;
            margin-bottom: 10px;
        }

        .example-box {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .example-box h4 {
            color: #1976d2;
            margin-bottom: 15px;
        }

        .stats-container {
            display: flex;
            justify-content: space-around;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--secondary-color);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-color);
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.show {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-toggle {
                display: block;
            }
            
            .mobile-overlay.show {
                display: block;
            }
            
            .header h1 {
                font-size: 2rem;
                margin-left: 60px;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .stats-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .container {
                padding: 10px;
            }
        }

        /* Loading animation */
        .loading {
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--secondary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- 移動端切換按鈕 -->
    <button class="mobile-toggle" onclick="toggleSidebar()">
        <span id="toggleIcon">☰</span>
    </button>
    
    <!-- 移動端遮罩 -->
    <div class="mobile-overlay" onclick="toggleSidebar()"></div>
    
    <!-- 側邊欄 -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>🐍 Python OOP</h2>
            <p style="font-size: 0.9rem; color: rgba(255,255,255,0.8); margin: 10px 0 0 0;">期末考總複習</p>
        </div>
        
        <div class="sidebar-nav">
            <div class="nav-item">
                <button class="nav-btn active" onclick="showSection('basics')">
                    <i>📚</i>物件導向基礎
                </button>
            </div>
            <div class="nav-item">
                <button class="nav-btn" onclick="showSection('advanced')">
                    <i>🚀</i>物件導向進階
                </button>
            </div>
            <div class="nav-item">
                <button class="nav-btn" onclick="showSection('comprehensions')">
                    <i>⚡</i>Python生成式
                </button>
            </div>
            <div class="nav-item">
                <button class="nav-btn" onclick="showSection('practice')">
                    <i>🏆</i>綜合練習
                </button>
            </div>
        </div>
        
        <div class="progress-section">
            <div class="progress-title">學習進度</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="stats-mini">
                <div class="stat-mini">
                    <div class="number" id="totalQuestions">0</div>
                    <div class="label">總題數</div>
                </div>
                <div class="stat-mini">
                    <div class="number" id="correctAnswers">0</div>
                    <div class="label">答對數</div>
                </div>
                <div class="stat-mini">
                    <div class="number" id="accuracy">0%</div>
                    <div class="label">準確率</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 主要內容區域 -->
    <div class="main-content" id="mainContent">
        <div class="container">
            <div class="header">
                <h1>🐍 Python 物件導向程式設計期末考總複習</h1>
                <p>一站式互動學習平台 - 掌握OOP核心概念與Python生成式語法</p>
            </div>

        <!-- 物件導向基礎 -->
        <div id="basics" class="section active">
            <div class="section-header">
                📚 第一部分: 物件導向基礎 (Foundations of OOP)
            </div>
            <div class="section-content">
                <div class="concept-card">
                    <div class="concept-title">1. 類別 (Class) 與 物件 (Object)</div>
                    <div class="concept-description">
                        <strong>類別 (Class)</strong>: 一個藍圖或模板，描述一群擁有相同屬性和方法的物件。<br>
                        <strong>物件 (Object)</strong>: 根據類別這個藍圖建立出來的實體 (Instance)。
                    </div>
                    
                    <div class="memory-tip">
                        <h4>🧠 記憶技巧</h4>
                        <p>把「類別」想像成「汽車設計圖」，而「物件」就是根據這張設計圖生產出來的每一輛「汽車」。設計圖只有一張，但汽車可以有很多輛，每輛車的顏色、車牌號碼（屬性）都可以不同。</p>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: MyComplex 類別</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="code1">
# 定義一個 MyComplex 類別 (藍圖)
class MyComplex:
    # 類別屬性 (預設值)
    re = 3
    im = 4
    
    # 方法 (物件的功能)
    def display(self):
        # self 代表物件本身
        return f'({self.re}+{self.im}i)'

# 根據 MyComplex 類別建立一個物件 z (實體)
z = MyComplex()

# 存取物件的屬性與方法
print(f"z 的實部是: {z.re}")      # 輸出: z 的實部是: 3
print(f"z 的表示法: {z.display()}") # 輸出: z 的表示法: (3+4i)
                            </textarea>
                            <button class="run-btn" onclick="runCode('code1', 'output1')">▶️ 執行程式碼</button>
                            <div class="output" id="output1"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">2. 屬性 (Attribute) 的操作</div>
                    <div class="concept-description">
                        屬性分為<strong>類別屬性</strong>和<strong>實例屬性</strong>: 
                        <ul style="margin: 15px 0; padding-left: 30px;">
                            <li><strong>類別屬性</strong>: 由所有該類別的物件共享</li>
                            <li><strong>實例屬性</strong>: 屬於特定物件的屬性，會遮蓋同名的類別屬性</li>
                        </ul>
                    </div>

                    <div class="key-points">
                        <h4>⚠️ 常見錯誤</h4>
                        <p>混淆類別屬性和實例屬性。當你透過物件修改屬性時（z.re = 5），你是在建立或修改該物件的「實例屬性」，並不會影響到類別或其他物件。</p>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 屬性操作</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="code2">
class MyComplex:
    # 類別屬性
    re = 3
    im = 4
    
    def display(self):
        return f'({self.re}+{self.im}i)'

# 建立第一個物件
z1 = MyComplex()
print(f"z1 的初始值: {z1.display()}")

# 修改 z1 的屬性 (這是實例屬性)
z1.re = 5
z1.im = 12
print(f"z1 修改後: {z1.display()}")

# 建立第二個物件 z2，它不受 z1 影響
z2 = MyComplex()
print(f"z2 的初始值: {z2.display()}")

# 修改 MyComplex 類別的屬性
MyComplex.re = 7
MyComplex.im = 24

# 建立第三個物件 z3，它會採用新的類別屬性
z3 = MyComplex()
print(f"z3 的初始值: {z3.display()}")

# z1 和 z2 不受類別屬性變更的影響
print(f"z1 仍然是: {z1.display()}")
print(f"z2 現在是: {z2.display()}")  # z2沒有實例屬性，所以會使用新的類別屬性
                            </textarea>
                            <button class="run-btn" onclick="runCode('code2', 'output2')">▶️ 執行程式碼</button>
                            <div class="output" id="output2"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">3. 建構子 (__init__)</div>
                    <div class="concept-description">
                        <code>__init__</code> 是一個特殊的方法（建構子），當你建立新物件時，Python會自動呼叫它來進行初始化。
                    </div>

                    <div class="key-points">
                        <h4>💡 學習重點</h4>
                        <ul>
                            <li>第一個參數永遠是 <code>self</code>，代表正在被建立的物件</li>
                            <li>可以為參數設定預設值，讓物件建立時更有彈性</li>
                            <li>通常用來設定實例屬性的初始值</li>
                        </ul>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 建構子</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="code3">
class MyComplex:
    # 建構子，帶有預設值
    def __init__(self, x=3, y=4):
        print("建構子 __init__ 被呼叫了！")
        self.re = x  # 建立實例屬性 re
        self.im = y  # 建立實例屬性 im
    
    def display(self):
        return f'({self.re}+{self.im}i)'

# 建立物件時，參數會傳給 __init__
z1 = MyComplex(5, 12)
print(z1.display())

# 不提供參數，則使用預設值
z2 = MyComplex()
print(z2.display())

# 只提供一個參數
z3 = MyComplex(10)
print(z3.display())
                            </textarea>
                            <button class="run-btn" onclick="runCode('code3', 'output3')">▶️ 執行程式碼</button>
                            <div class="output" id="output3"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">4. 物件的顯示 (__str__ 與 __repr__)</div>
                    <div class="concept-description">
                        客製化物件的字串表示方式: 
                        <ul style="margin: 15px 0; padding-left: 30px;">
                            <li><strong>__str__(self)</strong>: 給使用者看的，易於閱讀的字串表示</li>
                            <li><strong>__repr__(self)</strong>: 給開發者看的，明確無歧義的字串表示</li>
                        </ul>
                    </div>

                    <div class="memory-tip">
                        <h4>🧠 記憶技巧</h4>
                        <p><strong>str</strong> for <strong>String</strong> (給人看)，<strong>repr</strong> for <strong>Representation</strong> (給機器/開發者看)</p>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 字串表示</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="code4">
class MyComplex:
    def __init__(self, x=3, y=4):
        self.re = x
        self.im = y
    
    # 給使用者看的 (print)
    def __str__(self):
        return f"這是一個複數: {self.re} + {self.im}i"
    
    # 給開發者看的 (直接顯示)
    def __repr__(self):
        return f"MyComplex({self.re}, {self.im})"

z = MyComplex(5, 12)
print("使用 print():")
print(z)         # 呼叫 __str__

print("\n使用 repr():")
print(repr(z))   # 呼叫 __repr__

print("\n在列表中:")
print([z])       # 在容器中會呼叫 __repr__
                            </textarea>
                            <button class="run-btn" onclick="runCode('code4', 'output4')">▶️ 執行程式碼</button>
                            <div class="output" id="output4"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">5. 運算子多載 (Operator Overloading)</div>
                    <div class="concept-description">
                        讓內建的運算子（如 +, -, *, ==）能夠作用在你自訂的物件上，讓程式碼更直觀。
                    </div>

                    <div class="example-box">
                        <h4>🔢 運算子對應表</h4>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr style="background: var(--code-bg);">
                                <th style="padding: 10px; border: 1px solid var(--border-color);">運算子</th>
                                <th style="padding: 10px; border: 1px solid var(--border-color);">特殊方法</th>
                                <th style="padding: 10px; border: 1px solid var(--border-color);">描述</th>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">+</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">__add__(self, other)</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">加法</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">-</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">__sub__(self, other)</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">減法</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">*</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">__mul__(self, other)</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">乘法</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">len(obj)</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">__len__(self)</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">回傳長度</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">==</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">__eq__(self, other)</td>
                                <td style="padding: 10px; border: 1px solid var(--border-color);">等於比較</td>
                            </tr>
                        </table>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: MyVector 類別</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="code5">
class MyVector:
    def __init__(self, data_list=None):
        if data_list is None:
            data_list = []
        self.data = data_list.copy()
    
    def __str__(self):
        return str(self.data)
    
    def __len__(self):
        return len(self.data)
    
    def __add__(self, other):
        # 檢查兩個向量長度是否相同
        if len(self) != len(other):
            print("錯誤: 向量長度不匹配，無法相加！")
            return MyVector()  # 回傳一個空向量
        
        # 建立新向量來儲存結果
        new_data = []
        for i in range(len(self)):
            new_data.append(self.data[i] + other.data[i])
        
        return MyVector(new_data)
    
    def __eq__(self, other):
        return self.data == other.data

# --- 使用 ---
v1 = MyVector([1, 2, 3])
v2 = MyVector([4, 5, 6])
v3 = MyVector([7, 8])

print(f"v1 = {v1}")
print(f"v2 = {v2}")
print(f"v3 = {v3}")

# 因為定義了 __add__，所以可以用 +
result = v1 + v2
print(f"\n{v1} + {v2} = {result}")

# 長度不同，觸發錯誤處理
result_fail = v1 + v3
print(f"失敗的相加結果: {result_fail}")

# 測試 __eq__
v4 = MyVector([1, 2, 3])
print(f"\nv1 == v4: {v1 == v4}")
print(f"v1 == v2: {v1 == v2}")
                            </textarea>
                            <button class="run-btn" onclick="runCode('code5', 'output5')">▶️ 執行程式碼</button>
                            <div class="output" id="output5"></div>
                        </div>
                    </div>
                </div>

                <!-- 基礎概念測驗 -->
                <div class="quiz-container">
                    <div class="quiz-header">🧪 基礎概念測驗</div>
                    <div class="question" data-answer="1">
                        <div class="question-text">1. 以下關於類別和物件的描述，何者正確？</div>
                        <ul class="options">
                            <li class="option" data-value="0">類別是物件的實體，物件是類別的藍圖</li>
                            <li class="option" data-value="1">類別是藍圖或模板，物件是根據類別建立的實體</li>
                            <li class="option" data-value="2">類別和物件是完全相同的概念</li>
                            <li class="option" data-value="3">一個類別只能建立一個物件</li>
                        </ul>
                    </div>

                    <div class="question" data-answer="2">
                        <div class="question-text">2. 執行以下程式碼後，輸出結果是什麼？</div>
                        <pre style="background: var(--code-bg); padding: 15px; border-radius: 5px;">
class Test:
    x = 10

t1 = Test()
t2 = Test()
t1.x = 20
print(t2.x)
                        </pre>
                        <ul class="options">
                            <li class="option" data-value="0">20</li>
                            <li class="option" data-value="1">錯誤</li>
                            <li class="option" data-value="2">10</li>
                            <li class="option" data-value="3">0</li>
                        </ul>
                    </div>

                    <div class="question" data-answer="1">
                        <div class="question-text">3. __str__ 和 __repr__ 的主要差異是什麼？</div>
                        <ul class="options">
                            <li class="option" data-value="0">沒有差異，可以互換使用</li>
                            <li class="option" data-value="1">__str__ 給使用者看，__repr__ 給開發者看</li>
                            <li class="option" data-value="2">__str__ 給開發者看，__repr__ 給使用者看</li>
                            <li class="option" data-value="3">__str__ 用於字串操作，__repr__ 用於數值操作</li>
                        </ul>
                    </div>

                    <button class="submit-btn" onclick="checkBasicsQuiz()">提交答案</button>
                    <div id="basicsScore" class="score-display" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- 物件導向進階 -->
        <div id="advanced" class="section">
            <div class="section-header">
                🚀 第二部分: 物件導向進階 (Advanced OOP)
            </div>
            <div class="section-content">
                <div class="concept-card">
                    <div class="concept-title">1. 封裝 (Encapsulation): 私有成員</div>
                    <div class="concept-description">
                        封裝的核心思想是「隱藏內部細節」，不讓外部程式碼隨意存取或修改物件的內部狀態。
                    </div>

                    <div class="key-points">
                        <h4>🛡️ 為什麼要封裝？</h4>
                        <ul>
                            <li><strong>保護資料</strong>: 防止資料被意外或惡意地改成不合理的狀態</li>
                            <li><strong>降低耦合</strong>: 內部實作可以隨時修改，只要公開的接口不變</li>
                            <li><strong>提高維護性</strong>: 減少外部對內部細節的依賴</li>
                        </ul>
                    </div>

                    <div class="example-box">
                        <h4>🔧 實現方式</h4>
                        <p>在屬性或方法名稱前加上兩個底線 <code>__</code>，例如 <code>self.__radius</code>。Python會對這個名稱進行「名稱修飾 (Name Mangling)」。</p>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">2. Getter 與 Setter 方法</div>
                    <div class="concept-description">
                        這是實現封裝的標準模式: 
                        <ul style="margin: 15px 0; padding-left: 30px;">
                            <li><strong>Setter</strong>: 用來設定私有屬性的值，可以加入檢查邏輯</li>
                            <li><strong>Getter</strong>: 用來讀取私有屬性的值</li>
                        </ul>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: Circle 類別</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="advanced_code1">
class Circle:
    def __init__(self, cx=0, cy=0, r=1):
        self.cx = cx
        self.cy = cy
        # 在建構子中就透過 setter 來設定半徑，確保初始值也合法
        self.set_radius(r)
    
    def __str__(self):
        # 在類別內部，可以用 self.__radius 來存取
        return f"圓心:({self.cx}, {self.cy}), 半徑:{self.__radius}"
    
    # Setter 方法
    def set_radius(self, r):
        if r < 0:
            # 如果值不合法，拋出錯誤，阻止賦值
            raise ValueError("半徑不能為負值")
        self.__radius = r
    
    # Getter 方法
    def get_radius(self):
        return self.__radius
    
    def area(self):
        # 計算面積時，使用私有屬性
        return 3.14159 * self.__radius ** 2

# --- 使用 ---
try:
    c1 = Circle(0, 0, 5)
    print(c1)
    print(f"面積: {c1.area():.2f}")
    
    print(f"透過 getter 取得半徑: {c1.get_radius()}")
    
    # 修改半徑
    c1.set_radius(10)
    print(f"修改後: {c1}")
    
    # 試圖設定一個不合法的值
    c1.set_radius(-2)
    
except ValueError as e:
    print(f"發生錯誤: {e}")

# 你無法從外部直接存取 __radius
# print(c1.__radius)  # 這行會引發 AttributeError
                            </textarea>
                            <button class="run-btn" onclick="runCode('advanced_code1', 'advanced_output1')">▶️ 執行程式碼</button>
                            <div class="output" id="advanced_output1"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">3. 繼承 (Inheritance)</div>
                    <div class="concept-description">
                        繼承允許你建立一個新類別（子類別），它會繼承一個既有類別（父類別）的所有非私有成員。
                    </div>

                    <div class="key-points">
                        <h4>✨ 繼承的優點</h4>
                        <ul>
                            <li><strong>程式碼重用</strong>: 不用重複撰寫相同的功能</li>
                            <li><strong>易於擴充</strong>: 可以在子類別中新增父類別沒有的功能</li>
                            <li><strong>建立層次關係</strong>: 更好地組織程式碼，反映真實世界的關係</li>
                        </ul>
                    </div>

                    <div class="example-box">
                        <h4>📝 語法</h4>
                        <code>class ChildClass(ParentClass):</code>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">4. 覆蓋 (Overriding) 與 super()</div>
                    <div class="concept-description">
                        <ul style="margin: 15px 0; padding-left: 30px;">
                            <li><strong>覆蓋 (Overriding)</strong>: 子類別定義同名方法來覆蓋父類別的方法</li>
                            <li><strong>super()</strong>: 在子類別中呼叫被覆蓋的父類別版本的方法</li>
                        </ul>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 繼承與覆蓋</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="advanced_code2">
# 父類別
class Animal:
    def __init__(self, name):
        self.name = name
        print(f"動物 {name} 被創建了")
    
    def speak(self):
        return "我不知道怎麼叫..."
    
    def info(self):
        return f"我是 {self.name}"

# 子類別，繼承自 Animal
class Dog(Animal):
    def __init__(self, name, breed):
        # 呼叫父類別的建構子，完成 name 的初始化
        super().__init__(name)
        self.breed = breed  # 新增自己的屬性
        print(f"狗狗品種: {breed}")
    
    # 覆蓋父類別的 speak 方法
    def speak(self):
        return "汪！汪！"
    
    # 新增子類別特有的方法
    def fetch(self):
        return f"{self.name} 正在撿球！"
    
    # 覆蓋 info 方法，但仍使用父類別的部分功能
    def info(self):
        basic_info = super().info()  # 呼叫父類別的 info()
        return f"{basic_info}，我是一隻 {self.breed}"

# 另一個子類別
class Cat(Animal):
    def speak(self):
        return "喵～"
    
    def climb(self):
        return f"{self.name} 正在爬樹！"

# --- 使用 ---
print("=== 創建動物 ===")
generic_animal = Animal("神秘生物")
print(f"{generic_animal.info()} 說: {generic_animal.speak()}")

print("\n=== 創建狗狗 ===")
my_dog = Dog("小白", "柴犬")
print(f"{my_dog.info()} 說: {my_dog.speak()}")
print(my_dog.fetch())

print("\n=== 創建貓咪 ===")
my_cat = Cat("咪咪")
print(f"{my_cat.info()} 說: {my_cat.speak()}")
print(my_cat.climb())

# 展示繼承的特性
print(f"\n=== 類別關係 ===")
print(f"my_dog 是 Dog 的實例嗎？ {isinstance(my_dog, Dog)}")
print(f"my_dog 是 Animal 的實例嗎？ {isinstance(my_dog, Animal)}")
                            </textarea>
                            <button class="run-btn" onclick="runCode('advanced_code2', 'advanced_output2')">▶️ 執行程式碼</button>
                            <div class="output" id="advanced_output2"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">5. 多型 (Polymorphism)</div>
                    <div class="concept-description">
                        多型指的是不同的物件（即使來自不同的類別）可以用同樣的方式對待，只要它們共享一個共通的介面。
                    </div>

                    <div class="memory-tip">
                        <h4>🧠 多型的精髓</h4>
                        <p>「不管你是圓形還是橢圓，我都可以呼叫 .area() 來計算面積」。它讓我們的程式碼更有彈性，可以處理多種類型的物件。</p>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 多型應用</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="advanced_code3">
# 定義一個基礎的形狀類別
class Shape:
    def __init__(self, name):
        self.name = name
    
    def area(self):
        raise NotImplementedError("子類別必須實作 area 方法")
    
    def info(self):
        return f"我是 {self.name}"

# 圓形類別
class Circle(Shape):
    def __init__(self, radius):
        super().__init__("圓形")
        self.radius = radius
    
    def area(self):
        return 3.14159 * self.radius ** 2

# 矩形類別
class Rectangle(Shape):
    def __init__(self, width, height):
        super().__init__("矩形")
        self.width = width
        self.height = height
    
    def area(self):
        return self.width * self.height

# 三角形類別
class Triangle(Shape):
    def __init__(self, base, height):
        super().__init__("三角形")
        self.base = base
        self.height = height
    
    def area(self):
        return 0.5 * self.base * self.height

# 多型的關鍵: 這個函式不在乎傳進來的是什麼形狀
def print_shape_info(shape_object):
    print(f"{shape_object.info()}")
    print(f"面積: {shape_object.area():.2f}")
    print("-" * 20)

# 多型的另一個應用: 計算總面積
def calculate_total_area(shapes_list):
    total = 0
    for shape in shapes_list:
        total += shape.area()  # 每個形狀都有 area() 方法
    return total

# --- 使用多型 ---
# 建立不同的形狀物件
circle = Circle(5)
rectangle = Rectangle(4, 6)
triangle = Triangle(3, 8)

# 將不同類別的物件放在同一個列表中
shapes = [circle, rectangle, triangle]

print("=== 個別形狀資訊 ===")
# 對每個形狀物件呼叫相同的函式
for shape in shapes:
    print_shape_info(shape)

print(f"=== 總面積計算 ===")
total_area = calculate_total_area(shapes)
print(f"所有形狀的總面積: {total_area:.2f}")

# 展示多型的威力: 可以輕鬆新增新的形狀類別
class Ellipse(Shape):
    def __init__(self, a, b):
        super().__init__("橢圓")
        self.a = a  # 長軸
        self.b = b  # 短軸
    
    def area(self):
        return 3.14159 * self.a * self.b

ellipse = Ellipse(3, 2)
shapes.append(ellipse)

print(f"\n=== 新增橢圓後的總面積 ===")
new_total = calculate_total_area(shapes)
print(f"包含橢圓的總面積: {new_total:.2f}")
                            </textarea>
                            <button class="run-btn" onclick="runCode('advanced_code3', 'advanced_output3')">▶️ 執行程式碼</button>
                            <div class="output" id="advanced_output3"></div>
                        </div>
                    </div>
                </div>

                <!-- 進階概念測驗 -->
                <div class="quiz-container">
                    <div class="quiz-header">🎯 進階概念測驗</div>
                    <div class="question" data-answer="2">
                        <div class="question-text">1. 關於封裝的描述，何者錯誤？</div>
                        <ul class="options">
                            <li class="option" data-value="0">封裝可以保護資料不被外部隨意修改</li>
                            <li class="option" data-value="1">使用兩個底線__可以建立私有成員</li>
                            <li class="option" data-value="2">Python的私有成員是絕對無法從外部存取的</li>
                            <li class="option" data-value="3">Getter和Setter是實現封裝的常見模式</li>
                        </ul>
                    </div>

                    <div class="question" data-answer="1">
                        <div class="question-text">2. 在子類別中，super()的主要作用是什麼？</div>
                        <ul class="options">
                            <li class="option" data-value="0">建立一個新的父類別物件</li>
                            <li class="option" data-value="1">呼叫父類別的方法</li>
                            <li class="option" data-value="2">檢查類別的繼承關係</li>
                            <li class="option" data-value="3">刪除父類別的屬性</li>
                        </ul>
                    </div>

                    <div class="question" data-answer="3">
                        <div class="question-text">3. 多型的主要優點是什麼？</div>
                        <ul class="options">
                            <li class="option" data-value="0">提高程式執行速度</li>
                            <li class="option" data-value="1">減少記憶體使用量</li>
                            <li class="option" data-value="2">簡化類別定義</li>
                            <li class="option" data-value="3">讓程式碼更有彈性，可以處理多種類型的物件</li>
                        </ul>
                    </div>

                    <button class="submit-btn" onclick="checkAdvancedQuiz()">提交答案</button>
                    <div id="advancedScore" class="score-display" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- Python生成式 -->
        <div id="comprehensions" class="section">
            <div class="section-header">
                ⚡ 第三部分: Python 生成式與資料結構
            </div>
            <div class="section-content">
                <div class="concept-card">
                    <div class="concept-title">1. 條件運算式 (三元運算子)</div>
                    <div class="concept-description">
                        讓你用一行程式碼完成簡單的 if-else 判斷，讓程式碼更簡潔優雅。
                    </div>

                    <div class="example-box">
                        <h4>📝 語法</h4>
                        <code>value_if_true if condition else value_if_false</code>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 條件運算式</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="comp_code1">
# 基本的條件運算式
score = 85
result = "及格" if score >= 60 else "不及格"
print(f"分數 {score}: {result}")

# 多個條件運算式的組合
age = 17
status = "成年人" if age >= 18 else "未成年"
print(f"年齡 {age}: {status}")

# 在函式中使用
def get_grade(score):
    return "A" if score >= 90 else "B" if score >= 80 else "C" if score >= 70 else "D" if score >= 60 else "F"

# 測試不同分數
scores = [95, 87, 73, 65, 45]
for s in scores:
    grade = get_grade(s)
    print(f"分數 {s} -> 等級 {grade}")

# 在列表操作中使用
numbers = [-3, -1, 0, 2, 5, -8, 10]
print(f"原始數字: {numbers}")

# 將負數轉為0，正數保持不變
positive_numbers = [x if x > 0 else 0 for x in numbers]
print(f"處理後: {positive_numbers}")

# 絕對值處理
abs_numbers = [x if x >= 0 else -x for x in numbers]
print(f"絕對值: {abs_numbers}")
                            </textarea>
                            <button class="run-btn" onclick="runCode('comp_code1', 'comp_output1')">▶️ 執行程式碼</button>
                            <div class="output" id="comp_output1"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">2. 串列生成式 (List Comprehension)</div>
                    <div class="concept-description">
                        Python的一大特色，能用極其簡潔的語法從一個可迭代物件產生新的串列。
                    </div>

                    <div class="example-box">
                        <h4>📝 語法</h4>
                        <ul>
                            <li><strong>基本語法</strong>: <code>[expression for item in iterable]</code></li>
                            <li><strong>帶條件</strong>: <code>[expression for item in iterable if condition]</code></li>
                        </ul>
                    </div>

                    <div class="memory-tip">
                        <h4>🧠 學習技巧</h4>
                        <p>把它拆開來念，就跟 for 迴圈一模一樣: <br><code>[x*x for x in range(10) if x % 2 == 0]</code><br>「我要一個 x*x 的串列，這個 x 來自 range(10)，但前提是 x 必須是偶數。」</p>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 串列生成式</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="comp_code2">
# === 基本串列生成式 ===
print("=== 基本用法 ===")

# 傳統 for 迴圈寫法
squares_traditional = []
for i in range(10):
    squares_traditional.append(i * i)
print(f"傳統方法: {squares_traditional}")

# 串列生成式寫法
squares_comp = [i * i for i in range(10)]
print(f"生成式: {squares_comp}")

# === 帶條件的串列生成式 ===
print("\n=== 帶條件的用法 ===")

# 只要偶數的平方
even_squares = [i * i for i in range(10) if i % 2 == 0]
print(f"偶數平方: {even_squares}")

# 奇數的立方
odd_cubes = [i ** 3 for i in range(10) if i % 2 == 1]
print(f"奇數立方: {odd_cubes}")

# === 字串處理 ===
print("\n=== 字串處理 ===")
words = ["hello", "world", "python", "programming"]

# 轉換為大寫
upper_words = [word.upper() for word in words]
print(f"大寫: {upper_words}")

# 只要長度大於5的字
long_words = [word for word in words if len(word) > 5]
print(f"長字: {long_words}")

# 每個字的長度
word_lengths = [len(word) for word in words]
print(f"字長: {word_lengths}")

# === 巢狀迴圈 ===
print("\n=== 巢狀迴圈 ===")

# 建立座標點
coordinates = [(x, y) for x in range(3) for y in range(3)]
print(f"座標點: {coordinates}")

# 乘法表的一部分
multiplication = [f"{i}x{j}={i*j}" for i in range(1, 4) for j in range(1, 4)]
print(f"乘法表: {multiplication}")

# === 複雜條件 ===
print("\n=== 複雜條件 ===")
numbers = range(1, 21)

# 能被3整除但不能被5整除的數
special_numbers = [n for n in numbers if n % 3 == 0 and n % 5 != 0]
print(f"特殊數字: {special_numbers}")

# 質數檢查（簡單版）
def is_prime(n):
    if n < 2:
        return False
    for i in range(2, int(n**0.5) + 1):
        if n % i == 0:
            return False
    return True

primes = [n for n in range(2, 30) if is_prime(n)]
print(f"質數: {primes}")
                            </textarea>
                            <button class="run-btn" onclick="runCode('comp_code2', 'comp_output2')">▶️ 執行程式碼</button>
                            <div class="output" id="comp_output2"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">3. zip() 函式</div>
                    <div class="concept-description">
                        <code>zip()</code> 可以把多個可迭代物件「拉鍊」在一起，將它們對應位置的元素組成一個個元組。
                    </div>

                    <div class="key-points">
                        <h4>💡 重要特性</h4>
                        <ul>
                            <li>zip() 會在最短的序列結束時停止</li>
                            <li>返回的是 zip 物件，通常需要轉換為 list 或在迴圈中使用</li>
                            <li>可以同時處理多個序列</li>
                        </ul>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: zip() 函式</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="comp_code3">
# === 基本 zip 用法 ===
print("=== 基本 zip 用法 ===")
names = ['David', 'Johnny', 'Sean', 'Alice']
ages = [37, 18, 42, 25]
cities = ['台北', '高雄', '台中', '新竹']

# zip 會產生一個 zip 物件
zipped_data = list(zip(names, ages))
print(f"姓名和年齡: {zipped_data}")

# 三個列表一起 zip
all_info = list(zip(names, ages, cities))
print(f"完整資訊: {all_info}")

# === 長度不同的列表 ===
print("\n=== 長度不同的列表 ===")
short_list = [1, 2, 3]
long_list = [10, 20, 30, 40, 50]

zipped_short = list(zip(short_list, long_list))
print(f"不同長度的zip: {zipped_short}")  # 會在短的結束時停止

# === 在迴圈中使用 zip ===
print("\n=== 在迴圈中使用 ===")
subjects = ['數學', '英文', '歷史', '化學']
scores = [85, 92, 78, 88]

print("學生成績單: ")
for subject, score in zip(subjects, scores):
    grade = "優秀" if score >= 90 else "良好" if score >= 80 else "普通"
    print(f"{subject}: {score}分 ({grade})")

# === zip 的逆操作: 解壓縮 ===
print("\n=== zip 的逆操作 ===")
paired_data = [('Alice', 25), ('Bob', 30), ('Charlie', 35)]
print(f"原始配對: {paired_data}")

# 使用 * 運算符解壓縮
names_unpacked, ages_unpacked = zip(*paired_data)
print(f"解壓後的姓名: {list(names_unpacked)}")
print(f"解壓後的年齡: {list(ages_unpacked)}")

# === zip 與 enumerate 組合 ===
print("\n=== zip 與 enumerate 組合 ===")
fruits = ['蘋果', '香蕉', '橘子']
prices = [30, 25, 35]

print("水果價目表: ")
for index, (fruit, price) in enumerate(zip(fruits, prices), 1):
    print(f"{index}. {fruit}: ${price}")

# === 實用範例: 計算向量內積 ===
print("\n=== 實用範例: 向量內積 ===")
vector1 = [1, 2, 3, 4]
vector2 = [5, 6, 7, 8]

# 使用 zip 計算內積
dot_product = sum(a * b for a, b in zip(vector1, vector2))
print(f"向量1: {vector1}")
print(f"向量2: {vector2}")
print(f"內積: {dot_product}")

# 顯示計算過程
print("計算過程: ")
for i, (a, b) in enumerate(zip(vector1, vector2)):
    print(f"  {a} × {b} = {a * b}")
                            </textarea>
                            <button class="run-btn" onclick="runCode('comp_code3', 'comp_output3')">▶️ 執行程式碼</button>
                            <div class="output" id="comp_output3"></div>
                        </div>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">4. 字典生成式 (Dictionary Comprehension)</div>
                    <div class="concept-description">
                        與串列生成式類似，但用來快速建立字典。這是將兩個串列轉換成字典的最高效方法。
                    </div>

                    <div class="example-box">
                        <h4>📝 語法</h4>
                        <code>{key_expression: value_expression for item in iterable}</code>
                    </div>

                    <div class="key-points">
                        <h4>🎯 期末考重點</h4>
                        <p>字典生成式經常與 <code>zip()</code> 函式搭配使用，是將兩個串列轉換成一個字典的最高效、最 Pythonic 的方法。</p>
                    </div>

                    <div class="code-container">
                        <div class="code-header">程式碼範例: 字典生成式</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="comp_code4">
# === 基本字典生成式 ===
print("=== 基本字典生成式 ===")

# 數字的平方字典
squares_dict = {x: x**2 for x in range(1, 6)}
print(f"平方字典: {squares_dict}")

# 字串長度字典
words = ['apple', 'banana', 'cherry', 'date']
length_dict = {word: len(word) for word in words}
print(f"字串長度: {length_dict}")

# === 使用 zip() 建立字典 ===
print("\n=== 使用 zip() 建立字典 ===")
names = ['David', 'Johnny', 'Sean', 'Alice']
ages = [37, 18, 42, 25]

# 傳統 for 迴圈方法
info_dict_traditional = {}
for i in range(len(names)):
    info_dict_traditional[names[i]] = ages[i]
print(f"傳統方法: {info_dict_traditional}")

# 字典生成式 + zip()
info_dict_comp = {name: age for name, age in zip(names, ages)}
print(f"生成式方法: {info_dict_comp}")

# === 帶條件的字典生成式 ===
print("\n=== 帶條件的字典生成式 ===")

# 只要成年人的資料
adults_only = {name: age for name, age in zip(names, ages) if age >= 18}
print(f"成年人: {adults_only}")

# 偶數的平方（只要鍵是偶數）
even_squares = {x: x**2 for x in range(10) if x % 2 == 0}
print(f"偶數平方: {even_squares}")

# === 複雜的字典生成式 ===
print("\n=== 複雜的字典生成式 ===")

# 學生成績處理
students = ['Alice', 'Bob', 'Charlie', 'Diana']
scores = [85, 92, 78, 96]

# 建立成績等級字典
def get_grade(score):
    if score >= 90:
        return 'A'
    elif score >= 80:
        return 'B'
    elif score >= 70:
        return 'C'
    else:
        return 'D'

grade_dict = {student: get_grade(score) for student, score in zip(students, scores)}
print(f"成績等級: {grade_dict}")

# 建立詳細資訊字典
detailed_info = {
    student: {
        'score': score, 
        'grade': get_grade(score),
        'status': 'Pass' if score >= 70 else 'Fail'
    } 
    for student, score in zip(students, scores)
}

print("\n詳細成績資訊: ")
for student, info in detailed_info.items():
    print(f"{student}: {info}")

# === 字典轉換 ===
print("\n=== 字典轉換 ===")
original_dict = {'a': 1, 'b': 2, 'c': 3, 'd': 4}

# 值翻倍
doubled_dict = {k: v * 2 for k, v in original_dict.items()}
print(f"值翻倍: {doubled_dict}")

# 鍵值對調
swapped_dict = {v: k for k, v in original_dict.items()}
print(f"鍵值對調: {swapped_dict}")

# 只保留偶數值
even_values = {k: v for k, v in original_dict.items() if v % 2 == 0}
print(f"偶數值: {even_values}")

# === 巢狀字典生成式 ===
print("\n=== 巢狀字典生成式 ===")

# 建立乘法表字典
multiplication_table = {
    i: {j: i * j for j in range(1, 4)} 
    for i in range(1, 4)
}

print("乘法表字典: ")
for i, row in multiplication_table.items():
    print(f"{i}: {row}")
                            </textarea>
                            <button class="run-btn" onclick="runCode('comp_code4', 'comp_output4')">▶️ 執行程式碼</button>
                            <div class="output" id="comp_output4"></div>
                        </div>
                    </div>
                </div>

                <!-- 生成式測驗 -->
                <div class="quiz-container">
                    <div class="quiz-header">⚡ 生成式語法測驗</div>
                    <div class="question" data-answer="1">
                        <div class="question-text">1. 以下哪個條件運算式的寫法是正確的？</div>
                        <ul class="options">
                            <li class="option" data-value="0">if score >= 60 "pass" else "fail"</li>
                            <li class="option" data-value="1">"pass" if score >= 60 else "fail"</li>
                            <li class="option" data-value="2">score >= 60 ? "pass" : "fail"</li>
                            <li class="option" data-value="3">"pass" else "fail" if score >= 60</li>
                        </ul>
                    </div>

                    <div class="question" data-answer="2">
                        <div class="question-text">2. 以下程式碼的執行結果是什麼？</div>
                        <pre style="background: var(--code-bg); padding: 15px; border-radius: 5px;">
result = [x*2 for x in range(5) if x % 2 == 0]
print(result)
                        </pre>
                        <ul class="options">
                            <li class="option" data-value="0">[0, 2, 4, 6, 8]</li>
                            <li class="option" data-value="1">[0, 4, 8]</li>
                            <li class="option" data-value="2">[0, 4, 8]</li>
                            <li class="option" data-value="3">[2, 6]</li>
                        </ul>
                    </div>

                    <div class="question" data-answer="0">
                        <div class="question-text">3. zip() 函式的特性，何者正確？</div>
                        <ul class="options">
                            <li class="option" data-value="0">會在最短的序列結束時停止</li>
                            <li class="option" data-value="1">會在最長的序列結束時停止</li>
                            <li class="option" data-value="2">所有序列必須有相同長度</li>
                            <li class="option" data-value="3">只能處理兩個序列</li>
                        </ul>
                    </div>

                    <div class="question" data-answer="3">
                        <div class="question-text">4. 將兩個列表 names = ['A', 'B'] 和 ages = [20, 25] 轉換成字典的最佳方法是？</div>
                        <ul class="options">
                            <li class="option" data-value="0">{names[i]: ages[i] for i in range(len(names))}</li>
                            <li class="option" data-value="1">dict(names, ages)</li>
                            <li class="option" data-value="2">{i: j for i in names for j in ages}</li>
                            <li class="option" data-value="3">{name: age for name, age in zip(names, ages)}</li>
                        </ul>
                    </div>

                    <button class="submit-btn" onclick="checkComprehensionsQuiz()">提交答案</button>
                    <div id="comprehensionsScore" class="score-display" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- 綜合練習 -->
        <div id="practice" class="section">
            <div class="section-header">
                🏆 綜合練習與應考策略
            </div>
            <div class="section-content">
                <div class="concept-card">
                    <div class="concept-title">🎯 應考策略與總複習建議</div>
                    <div class="concept-description">
                        以下是針對期末考試的重點複習策略和常見考點整理。
                    </div>

                    <div class="key-points">
                        <h4>📝 復習策略</h4>
                        <ul>
                            <li><strong>動手寫程式碼</strong>: 只看是沒用的，把每個範例都親手打一遍</li>
                            <li><strong>理解 self</strong>: self 是物件導向中最關鍵的概念</li>
                            <li><strong>特殊方法是關鍵</strong>: 熟記 __init__, __str__, __repr__, __add__ 等</li>
                            <li><strong>解釋給別人聽</strong>: 用自己的話解釋「繼承」、「封裝」、「多型」</li>
                            <li><strong>生成式 > 迴圈</strong>: 優先使用生成式展現 Python 熟練度</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card">
                    <div class="concept-title">🔥 綜合練習題</div>
                    <div class="concept-description">
                        以下是結合所有概念的綜合練習，幫你檢驗學習成果。
                    </div>

                    <div class="code-container">
                        <div class="code-header">練習題: 建立一個學生管理系統</div>
                        <div class="code-content">
                            <textarea class="code-editor" id="practice_code1">
# 練習題: 實作一個完整的學生管理系統
class Student:
    # 類別屬性: 記錄學生總數
    total_students = 0
    
    def __init__(self, name, student_id, subjects_scores=None):
        if subjects_scores is None:
            subjects_scores = {}
        
        self.name = name
        self.__student_id = student_id  # 私有屬性
        self.__scores = subjects_scores.copy()  # 私有屬性
        
        # 增加學生總數
        Student.total_students += 1
        print(f"學生 {name} 已註冊，學號: {student_id}")
    
    def __str__(self):
        return f"學生: {self.name} (學號: {self.__student_id})"
    
    def __repr__(self):
        return f"Student('{self.name}', '{self.__student_id}', {self.__scores})"
    
    # Getter 方法
    def get_student_id(self):
        return self.__student_id
    
    def get_scores(self):
        return self.__scores.copy()  # 返回副本，避免外部修改
    
    # Setter 方法
    def add_score(self, subject, score):
        if not 0 <= score <= 100:
            raise ValueError("成績必須在 0-100 之間")
        self.__scores[subject] = score
        print(f"已為 {self.name} 新增 {subject} 成績: {score}")
    
    def calculate_average(self):
        if not self.__scores:
            return 0
        return sum(self.__scores.values()) / len(self.__scores)
    
    def get_grade(self):
        avg = self.calculate_average()
        if avg >= 90:
            return 'A'
        elif avg >= 80:
            return 'B'
        elif avg >= 70:
            return 'C'
        elif avg >= 60:
            return 'D'
        else:
            return 'F'
    
    # 運算子多載: 比較平均成績
    def __gt__(self, other):
        return self.calculate_average() > other.calculate_average()
    
    def __eq__(self, other):
        return self.calculate_average() == other.calculate_average()
    
    @classmethod
    def get_total_students(cls):
        return cls.total_students

# 子類別: 研究生
class GraduateStudent(Student):
    def __init__(self, name, student_id, subjects_scores=None, research_topic="未定"):
        super().__init__(name, student_id, subjects_scores)
        self.research_topic = research_topic
    
    def __str__(self):
        base_info = super().__str__()
        return f"{base_info} [研究生] - 研究主題: {self.research_topic}"
    
    def set_research_topic(self, topic):
        self.research_topic = topic
        print(f"{self.name} 的研究主題設定為: {topic}")

# 使用系統
print("=== 建立學生 ===")
# 建立普通學生
s1 = Student("王小明", "B001", {"數學": 85, "英文": 92, "物理": 78})
s2 = Student("李小華", "B002", {"數學": 88, "英文": 85, "物理": 90})

# 建立研究生
g1 = GraduateStudent("張博士", "G001", {"高等數學": 95, "研究方法": 88}, "人工智慧")

print(f"\n總學生數: {Student.get_total_students()}")

print("\n=== 學生資訊 ===")
students = [s1, s2, g1]
for student in students:
    print(student)
    print(f"  平均成績: {student.calculate_average():.2f}")
    print(f"  等級: {student.get_grade()}")
    print()

print("=== 新增成績 ===")
s1.add_score("化學", 90)
g1.set_research_topic("深度學習在醫學影像的應用")

print("\n=== 成績排名 ===")
# 使用生成式和排序
sorted_students = sorted(students, key=lambda x: x.calculate_average(), reverse=True)
rankings = [(i+1, student.name, student.calculate_average()) 
           for i, student in enumerate(sorted_students)]

print("排名 | 姓名 | 平均成績")
print("-" * 25)
for rank, name, avg in rankings:
    print(f"{rank:2d}   | {name:6s} | {avg:6.2f}")

print("\n=== 成績統計 ===")
# 使用字典生成式統計各科平均
all_scores = {}
for student in students:
    for subject, score in student.get_scores().items():
        if subject not in all_scores:
            all_scores[subject] = []
        all_scores[subject].append(score)

subject_averages = {
    subject: sum(scores) / len(scores) 
    for subject, scores in all_scores.items()
}

print("各科平均成績: ")
for subject, avg in subject_averages.items():
    print(f"{subject}: {avg:.2f}")

# 找出最高分的科目
best_subject = max(subject_averages, key=subject_averages.get)
print(f"\n表現最好的科目: {best_subject} ({subject_averages[best_subject]:.2f})")
            </textarea>
            <button class="run-btn" onclick="runCode('practice_code1', 'practice_output1')">▶️ 執行程式碼</button>
            <div class="output" id="practice_output1"></div>
        </div>
    </div>

    <div class="concept-card">
        <div class="concept-title">🧠 代碼輸出預測練習</div>
        <div class="concept-description">
            以下是期末考常見的代碼輸出預測題型，請仔細分析每行代碼的執行結果。
        </div>

        <div class="code-container">
            <div class="code-header">練習: 預測輸出結果</div>
            <div class="code-content">
                <textarea class="code-editor" id="practice_code2">
# 代碼輸出預測練習
print("=== 練習 1: 類別屬性 vs 實例屬性 ===")

class Counter:
    count = 0
    
    def __init__(self):
        Counter.count += 1
        self.instance_count = Counter.count

c1 = Counter()
c2 = Counter()
c3 = Counter()

print(f"Counter.count = {Counter.count}")
print(f"c1.instance_count = {c1.instance_count}")
print(f"c2.instance_count = {c2.instance_count}")
print(f"c3.instance_count = {c3.instance_count}")

# 修改類別屬性
Counter.count = 100
c4 = Counter()
print(f"建立 c4 後，Counter.count = {Counter.count}")
print(f"c4.instance_count = {c4.instance_count}")

print("\n=== 練習 2: 繼承和覆蓋 ===")

class Animal:
    def __init__(self, name):
        self.name = name
        print(f"Animal.__init__: {name}")
    
    def speak(self):
        return f"{self.name} makes a sound"

class Dog(Animal):
    def __init__(self, name, breed):
        print(f"Dog.__init__ 開始: {name}")
        super().__init__(name)
        self.breed = breed
        print(f"Dog.__init__ 結束: {breed}")
    
    def speak(self):
        return f"{self.name} barks"

class Puppy(Dog):
    def speak(self):
        parent_sound = super().speak()
        return f"{parent_sound} softly"

p = Puppy("小白", "柴犬")
print(p.speak())

print("\n=== 練習 3: 生成式組合 ===")

# 複雜的生成式
numbers = range(1, 6)
result1 = [x**2 for x in numbers if x % 2 == 0]
print(f"result1 = {result1}")

result2 = {x: [y for y in range(x)] for x in range(1, 4)}
print(f"result2 = {result2}")

# zip 和字典生成式
keys = ['a', 'b', 'c']
values = [1, 2, 3, 4, 5]  # 注意長度不同
result3 = {k: v*2 for k, v in zip(keys, values)}
print(f"result3 = {result3}")

print("\n=== 練習 4: 運算子多載 ===")

class Point:
    def __init__(self, x, y):
        self.x, self.y = x, y
    
    def __str__(self):
        return f"({self.x}, {self.y})"
    
    def __add__(self, other):
        return Point(self.x + other.x, self.y + other.y)
    
    def __mul__(self, scalar):
        return Point(self.x * scalar, self.y * scalar)

p1 = Point(1, 2)
p2 = Point(3, 4)
p3 = p1 + p2
p4 = p1 * 3

print(f"p1 = {p1}")
print(f"p2 = {p2}")
print(f"p1 + p2 = {p3}")
print(f"p1 * 3 = {p4}")

print("\n=== 練習 5: 條件運算式嵌套 ===")

def categorize_number(n):
    return ("正數" if n > 0 else "負數") if n != 0 else "零"

test_numbers = [-5, 0, 3, -1, 10]
categories = [categorize_number(n) for n in test_numbers]
print(f"數字分類: {list(zip(test_numbers, categories))}")

# 更複雜的條件運算式
grades = [95, 87, 73, 65, 45, 92]
descriptions = [
    f"{grade}分-{'優秀' if grade >= 90 else '良好' if grade >= 80 else '普通' if grade >= 70 else '需要努力'}"
    for grade in grades
]

for desc in descriptions:
    print(desc)
                </textarea>
                <button class="run-btn" onclick="runCode('practice_code2', 'practice_output2')">▶️ 執行程式碼</button>
                <div class="output" id="practice_output2"></div>
            </div>
        </div>
    </div>

    <!-- 綜合測驗 -->
    <div class="quiz-container">
        <div class="quiz-header">🏆 期末考模擬測驗</div>
        
        <div class="question" data-answer="2">
            <div class="question-text">1. 執行以下程式碼後，輸出結果是什麼？</div>
            <pre style="background: var(--code-bg); padding: 15px; border-radius: 5px;">
class Test:
    x = 5

t1 = Test()
t2 = Test()
t1.x = 10
Test.x = 15
t3 = Test()
print(t2.x, t3.x)
            </pre>
            <ul class="options">
                <li class="option" data-value="0">10 15</li>
                <li class="option" data-value="1">5 5</li>
                <li class="option" data-value="2">15 15</li>
                <li class="option" data-value="3">10 10</li>
            </ul>
        </div>

        <div class="question" data-answer="1">
            <div class="question-text">2. 關於 super() 的使用，以下何者正確？</div>
            <ul class="options">
                <li class="option" data-value="0">super() 只能在 __init__ 方法中使用</li>
                <li class="option" data-value="1">super() 可以呼叫父類別的任何方法</li>
                <li class="option" data-value="2">super() 會建立父類別的新實例</li>
                <li class="option" data-value="3">子類別必須使用 super() 才能繼承</li>
            </ul>
        </div>

        <div class="question" data-answer="3">
            <div class="question-text">3. 以下程式碼的執行結果是？</div>
            <pre style="background: var(--code-bg); padding: 15px; border-radius: 5px;">
result = {x: y for x in range(3) for y in range(2) if x + y == 2}
print(len(result))
            </pre>
            <ul class="options">
                <li class="option" data-value="0">6</li>
                <li class="option" data-value="1">3</li>
                <li class="option" data-value="2">2</li>
                <li class="option" data-value="3">1</li>
            </ul>
        </div>

        <div class="question" data-answer="0">
            <div class="question-text">4. 多型 (Polymorphism) 最主要體現在哪裡？</div>
            <ul class="options">
                <li class="option" data-value="0">不同類別的物件可以響應相同的方法調用</li>
                <li class="option" data-value="1">一個類別可以有多個建構子</li>
                <li class="option" data-value="2">物件可以改變自己的類別</li>
                <li class="option" data-value="3">方法可以有多個返回值</li>
            </ul>
        </div>

        <div class="question" data-answer="2">
            <div class="question-text">5. 以下哪個是最 Pythonic 的寫法？</div>
            <ul class="options">
                <li class="option" data-value="0">
                    <pre>result = []
for i in range(len(names)):
    result.append((names[i], ages[i]))</pre>
                </li>
                <li class="option" data-value="1">
                    <pre>result = []
for i, name in enumerate(names):
    result.append((name, ages[i]))</pre>
                </li>
                <li class="option" data-value="2">
                    <pre>result = list(zip(names, ages))</pre>
                </li>
                <li class="option" data-value="3">
                    <pre>result = [(names[i], ages[i]) for i in range(len(names))]</pre>
                </li>
            </ul>
        </div>

        <button class="submit-btn" onclick="checkFinalQuiz()">提交答案</button>
        <div id="finalScore" class="score-display" style="display: none;"></div>
    </div>

    <div class="concept-card">
        <div class="concept-title">🎓 學習完成！</div>
        <div class="concept-description">
            恭喜你完成了 Python 物件導向程式設計的完整學習！記住，程式設計是一門實踐的藝術，多寫多練才能真正掌握。
        </div>
        
        <div class="memory-tip">
            <h4>🔑 最後的叮嚀</h4>
            <ul>
                <li>理解概念比記住語法更重要</li>
                <li>多練習各種題型，特別是代碼輸出預測</li>
                <li>學會閱讀錯誤訊息，它們是你最好的老師</li>
                <li>保持好奇心，持續學習新的程式設計概念</li>
            </ul>
            </div>
        </div>
            </div>
        </div>
        </div>
        </div>
    </div>

    <div class="loading" id="loading" style="display: none;">
        <div class="spinner"></div>
        <p>正在載入 Python 環境...</p>
    </div>

    <script>
        let pyodide;
        let totalQuestions = 0;
        let correctAnswers = 0;

        // 初始化 Pyodide
        async function initPyodide() {
            if (!pyodide) {
                document.getElementById('loading').style.display = 'block';
                try {
                    pyodide = await loadPyodide();
                    console.log("Pyodide 載入完成");
                } catch (error) {
                    console.error("Pyodide 載入失敗:", error);
                } finally {
                    document.getElementById('loading').style.display = 'none';
                }
            }
        }

        // 頁面載入時初始化 Pyodide
        window.addEventListener('load', initPyodide);

        // 切換側邊欄顯示/隱藏
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.mobile-overlay');
            const icon = document.getElementById('toggleIcon');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('show');
                overlay.classList.toggle('show');
                icon.textContent = sidebar.classList.contains('show') ? '✕' : '☰';
            }
        }

        // 顯示不同章節
        function showSection(sectionId) {
            // 隱藏所有章節
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            // 顯示指定章節
            document.getElementById(sectionId).classList.add('active');

            // 更新導航按鈕
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // 在移動端點擊導航後隱藏側邊欄
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }

            // 更新進度條
            updateProgress();
            
            // 滾動到頂部
            document.querySelector('.main-content').scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // 執行 Python 程式碼
        async function runCode(codeId, outputId) {
            const code = document.getElementById(codeId).value;
            const output = document.getElementById(outputId);

            if (!pyodide) {
                output.textContent = "正在載入 Python 環境，請稍候...";
                await initPyodide();
            }

            try {
                // 重定向 stdout
                pyodide.runPython(`
import sys
from io import StringIO
sys.stdout = StringIO()
                `);

                // 執行用戶代碼
                pyodide.runPython(code);

                // 獲取輸出
                const stdout = pyodide.runPython("sys.stdout.getvalue()");
                output.textContent = stdout;

                // 重設 stdout
                pyodide.runPython("sys.stdout = sys.__stdout__");
            } catch (error) {
                output.textContent = `錯誤: ${error.message}`;
                output.style.color = '#e74c3c';
            }
        }

        // 檢查基礎概念測驗
        function checkBasicsQuiz() {
            checkQuiz('basicsScore', [
                { element: document.querySelector('[data-answer="1"]'), correctAnswer: 1 },
                { element: document.querySelector('[data-answer="2"]'), correctAnswer: 2 },
                { element: document.querySelector('[data-answer="1"]:nth-of-type(3)'), correctAnswer: 1 }
            ]);
        }

        // 檢查進階概念測驗
        function checkAdvancedQuiz() {
            const questions = document.querySelectorAll('#advanced .question');
            const answers = [2, 1, 3]; // 正確答案
            checkQuizGeneric('advancedScore', questions, answers);
        }

        // 檢查生成式測驗
        function checkComprehensionsQuiz() {
            const questions = document.querySelectorAll('#comprehensions .question');
            const answers = [1, 2, 0, 3]; // 正確答案
            checkQuizGeneric('comprehensionsScore', questions, answers);
        }

        // 檢查期末模擬測驗
        function checkFinalQuiz() {
            const questions = document.querySelectorAll('#practice .question');
            const answers = [2, 1, 3, 0, 2]; // 正確答案
            checkQuizGeneric('finalScore', questions, answers);
        }

        // 通用測驗檢查函數
        function checkQuizGeneric(scoreId, questions, correctAnswers) {
            let score = 0;
            const totalQuestions = questions.length;

            questions.forEach((question, index) => {
                const selectedOption = question.querySelector('.option.selected');
                const options = question.querySelectorAll('.option');
                
                if (selectedOption) {
                    const selectedValue = parseInt(selectedOption.dataset.value);
                    if (selectedValue === correctAnswers[index]) {
                        score++;
                        selectedOption.classList.add('correct');
                    } else {
                        selectedOption.classList.add('incorrect');
                        // 顯示正確答案
                        options[correctAnswers[index]].classList.add('correct');
                    }
                } else {
                    // 沒有選擇答案，顯示正確答案
                    options[correctAnswers[index]].classList.add('correct');
                }

                // 禁用所有選項
                options.forEach(option => {
                    option.style.pointerEvents = 'none';
                });
            });

            // 更新統計
            updateStats(totalQuestions, score);

            // 顯示分數
            const scoreDisplay = document.getElementById(scoreId);
            const percentage = Math.round((score / totalQuestions) * 100);
            scoreDisplay.innerHTML = `
                <h3>測驗結果</h3>
                <p>答對 ${score} / ${totalQuestions} 題</p>
                <p>正確率: ${percentage}%</p>
                ${percentage >= 80 ? '<p style="color: #27ae60;">🎉 表現優秀！</p>' : 
                  percentage >= 60 ? '<p style="color: #f39c12;">⚠️ 還需要多練習</p>' : 
                  '<p style="color: #e74c3c;">❌ 建議重新複習相關概念</p>'}
            `;
            scoreDisplay.style.display = 'block';
        }

        // 通用測驗檢查函數（舊版兼容）
        function checkQuiz(scoreId, questionsData) {
            let score = 0;
            const totalQuestions = questionsData.length;

            questionsData.forEach(({ element, correctAnswer }) => {
                const selectedOption = element.querySelector('.option.selected');
                const options = element.querySelectorAll('.option');
                
                if (selectedOption) {
                    const selectedValue = parseInt(selectedOption.dataset.value);
                    if (selectedValue === correctAnswer) {
                        score++;
                        selectedOption.classList.add('correct');
                    } else {
                        selectedOption.classList.add('incorrect');
                        // 顯示正確答案
                        options[correctAnswer].classList.add('correct');
                    }
                } else {
                    // 沒有選擇答案，顯示正確答案
                    options[correctAnswer].classList.add('correct');
                }

                // 禁用所有選項
                options.forEach(option => {
                    option.style.pointerEvents = 'none';
                });
            });

            // 更新統計
            updateStats(totalQuestions, score);

            // 顯示分數
            const scoreDisplay = document.getElementById(scoreId);
            const percentage = Math.round((score / totalQuestions) * 100);
            scoreDisplay.innerHTML = `
                <h3>測驗結果</h3>
                <p>答對 ${score} / ${totalQuestions} 題</p>
                <p>正確率: ${percentage}%</p>
                ${percentage >= 80 ? '<p style="color: #27ae60;">🎉 表現優秀！</p>' : 
                  percentage >= 60 ? '<p style="color: #f39c12;">⚠️ 還需要多練習</p>' : 
                  '<p style="color: #e74c3c;">❌ 建議重新複習相關概念</p>'}
            `;
            scoreDisplay.style.display = 'block';
        }

        // 更新統計資料
        function updateStats(questions, correct) {
            totalQuestions += questions;
            correctAnswers += correct;
            
            document.getElementById('totalQuestions').textContent = totalQuestions;
            document.getElementById('correctAnswers').textContent = correctAnswers;
            document.getElementById('accuracy').textContent = 
                totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) + '%' : '0%';
        }

        // 更新進度條
        function updateProgress() {
            const sections = document.querySelectorAll('.section');
            const activeSection = document.querySelector('.section.active');
            const currentIndex = Array.from(sections).indexOf(activeSection);
            const progress = ((currentIndex + 1) / sections.length) * 100;
            
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // 選項點擊事件
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('option')) {
                const question = e.target.closest('.question');
                const options = question.querySelectorAll('.option');
                
                // 清除之前的選擇
                options.forEach(option => option.classList.remove('selected'));
                
                // 設定新的選擇
                e.target.classList.add('selected');
            }
        });

        // 初始化進度條
        updateProgress();

        // 處理窗口大小變化
        window.addEventListener('resize', function() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.mobile-overlay');
            const icon = document.getElementById('toggleIcon');
            
            if (window.innerWidth > 768) {
                // 桌面模式：顯示側邊欄，隱藏遮罩
                sidebar.classList.remove('show');
                overlay.classList.remove('show');
                icon.textContent = '☰';
            } else {
                // 移動端模式：隱藏側邊欄
                sidebar.classList.remove('show');
                overlay.classList.remove('show');
                icon.textContent = '☰';
            }
        });

        // 添加鍵盤快捷鍵支持
        document.addEventListener('keydown', function(e) {
            // ESC鍵關閉側邊欄
            if (e.key === 'Escape' && window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('show')) {
                    toggleSidebar();
                }
            }
        });

        // 添加 smooth scrolling
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                setTimeout(() => {
                    const mainContent = document.querySelector('.main-content');
                    if (mainContent) {
                        mainContent.scrollTo({
                            top: 0,
                            behavior: 'smooth'
                        });
                    }
                }, 100);
            });
        });
    </script>
</body>
</html>