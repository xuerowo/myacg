<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>能源管理法填充題測驗（固定位置版）</title>
    <style>
        body {
            font-family: '微軟正黑體', 'Microsoft JhengHei', sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        h1 {
            color: #1a5276;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #1a5276;
        }
        h2 {
            color: #2874a6;
            margin-top: 30px;
            background-color: #eaf2f8;
            padding: 8px;
            border-radius: 5px;
        }
        .quiz-container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .question {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }
        input[type="text"] {
            border: none;
            border-bottom: 1px solid #3498db;
            padding: 5px 2px;
            margin: 0 2px;
            font-family: inherit;
            font-size: inherit;
            color: #e74c3c;
            background-color: #f9f9f9;
            vertical-align: middle;
            min-width: 20px; /* 設置最小寬度 */
            box-sizing: border-box;
        }
        input[type="text"]:focus {
            outline: none;
            border-bottom: 2px solid #2980b9;
            background-color: #ecf0f1;
        }
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        button {
            background-color: #2980b9;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #1a5276;
        }
        #reset {
            background-color: #95a5a6;
        }
        #reset:hover {
            background-color: #7f8c8d;
        }
        .progress-container {
            margin: 20px 0;
        }
        .progress {
            background-color: #ecf0f1;
            border-radius: 20px;
            height: 10px;
            overflow: hidden;
        }
        .progress-bar {
            background-color: #3498db;
            height: 100%;
            width: 0%;
            transition: width 0.5s;
        }
        .progress-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-top: 5px;
        }
        .hint {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-top: 5px;
            font-style: italic;
        }
        
        /* 評分模態框樣式 */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            overflow-y: auto; /* 允許垂直滾動 */
        }
        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: 5% auto; /* 調整上邊距使整個模態框可見 */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 500px;
            animation: modalAppear 0.3s ease-out;
            max-height: 90vh; /* 設置最大高度 */
            overflow-y: auto; /* 內容太多時允許垂直滾動 */
        }
        @keyframes modalAppear {
            from {transform: translateY(-50px); opacity: 0;}
            to {transform: translateY(0); opacity: 1;}
        }
        .modal-header {
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
            margin-bottom: 20px;
        }
        .modal-header h2 {
            margin: 0;
            color: #2c3e50;
            background-color: transparent;
            padding: 0;
        }
        .close-button {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #7f8c8d;
            cursor: pointer;
        }
        .close-button:hover {
            color: #34495e;
        }
        .score-display {
            text-align: center;
            margin: 20px 0;
        }
        .score-circle {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: #eaf2f8;
            border: 10px solid #3498db;
            font-size: 36px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .score-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .score-details p {
            margin: 10px 0;
            font-size: 16px;
        }
        .grade {
            font-size: 24px;
            font-weight: bold;
            color: #27ae60;
            margin: 15px 0;
        }
        .feedback {
            font-style: italic;
            color: #7f8c8d;
            margin: 15px 0;
        }
        .modal-actions {
            text-align: center;
            margin-top: 20px;
            padding-bottom: 15px; /* 確保底部按鈕有足夠空間 */
        }
        .correct-answer {
            background-color: #d4edda !important;
            border-bottom: 2px solid #28a745 !important;
        }
        .wrong-answer {
            background-color: #f8d7da !important;
            border-bottom: 2px solid #dc3545 !important;
        }
        .results-button {
            background-color: #e74c3c;
        }
        .results-button:hover {
            background-color: #c0392b;
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <h1>能源管理法填充題測驗</h1>
        
        <div class="progress-container">
            <div class="progress">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div class="progress-info">
                <span>完成進度：</span>
                <span id="progress-text">0/195 (0.0%)</span>
            </div>
        </div>
        
        <div class="hint">提示：題目中每個底線處都需要填入內容</div>
        
        <form id="quiz-form">
            <div id="quiz-content">
                <h2>第一章 總則</h2>
                <div class="question">
                    <p>1. 為加強管理<input type="text" class="blank-input" data-answer="能源" style="width: 40px;">，促進能源<input type="text" class="blank-input" data-answer="合理" style="width: 40px;">及<input type="text" class="blank-input" data-answer="有效" style="width: 40px;">使用，特制定本法。中央主管機關為確保全國能源<input type="text" class="blank-input" data-answer="供應" style="width: 40px;">及<input type="text" class="blank-input" data-answer="安全" style="width: 40px;">，考量<input type="text" class="blank-input" data-answer="環境" style="width: 40px;">衝擊及兼顧<input type="text" class="blank-input" data-answer="經濟" style="width: 40px;">發展，應擬訂<input type="text" class="blank-input" data-answer="能源發展綱領" style="width: 100px;">，報<input type="text" class="blank-input" data-answer="行政院" style="width: 60px;">核定施行。</p>
                </div>
                
                <div class="question">
                    <p>2. 本法所稱能源如左：一、<input type="text" class="blank-input" data-answer="石油" style="width: 40px;">及其產品。二、<input type="text" class="blank-input" data-answer="煤炭" style="width: 40px;">及其產品。三、<input type="text" class="blank-input" data-answer="天然氣" style="width: 60px;">。四、<input type="text" class="blank-input" data-answer="核子" style="width: 40px;">燃料。五、<input type="text" class="blank-input" data-answer="電能" style="width: 40px;">。六、其他經<input type="text" class="blank-input" data-answer="中央主管機關" style="width: 100px;">指定為能源者。</p>
                </div>
                
                <div class="question">
                    <p>3. 本法所稱<input type="text" class="blank-input" data-answer="主管" style="width: 40px;">機關：在中央為<input type="text" class="blank-input" data-answer="經濟部" style="width: 60px;">；在直轄市為<input type="text" class="blank-input" data-answer="直轄市政府" style="width: 100px;">；在縣（市）為<input type="text" class="blank-input" data-answer="縣（市）政府" style="width: 100px;">。</p>
                </div>
                
                <div class="question">
                    <p>4. 本法所稱<input type="text" class="blank-input" data-answer="能源供應" style="width: 80px;">事業，係指經營能源<input type="text" class="blank-input" data-answer="輸入" style="width: 40px;">、<input type="text" class="blank-input" data-answer="輸出" style="width: 40px;">、<input type="text" class="blank-input" data-answer="生產" style="width: 40px;">、<input type="text" class="blank-input" data-answer="運送" style="width: 40px;">、<input type="text" class="blank-input" data-answer="儲存" style="width: 40px;">、<input type="text" class="blank-input" data-answer="銷售" style="width: 40px;">等業務之事業。</p>
                </div>
                
                <div class="question">
                    <p>5. 中央主管機關得依<input type="text" class="blank-input" data-answer="預算" style="width: 40px;">法之規定，設置<input type="text" class="blank-input" data-answer="能源研究發展特種基金" style="width: 160px;">，訂定計畫，加強能源之研究發展工作。</p>
                </div>
                
                <div class="question">
                    <p>6. 能源研究發展特種基金之用途範圍如左：一、能源<input type="text" class="blank-input" data-answer="開發" style="width: 40px;">技術之研究發展及<input type="text" class="blank-input" data-answer="替代" style="width: 40px;">能源之研究。二、能源<input type="text" class="blank-input" data-answer="合理" style="width: 40px;">有效使用及<input type="text" class="blank-input" data-answer="節約" style="width: 40px;">技術、方法之研究發展。三、能源<input type="text" class="blank-input" data-answer="經濟" style="width: 40px;">分析及其<input type="text" class="blank-input" data-answer="情報" style="width: 40px;">資料之蒐集。四、能源<input type="text" class="blank-input" data-answer="規劃" style="width: 40px;">及技術等專業人員之<input type="text" class="blank-input" data-answer="培訓" style="width: 40px;">。五、其他經核定之支出。</p>
                </div>
                
                <div class="question">
                    <p>7. 法人或個人為前項第一款、第二款之研究，具有<input type="text" class="blank-input" data-answer="實用" style="width: 40px;">價值者，得予<input type="text" class="blank-input" data-answer="獎勵" style="width: 40px;">或<input type="text" class="blank-input" data-answer="補助" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>8. 能源研究發展基金之來源如下：一、<input type="text" class="blank-input" data-answer="綜合" style="width: 40px;">電業、<input type="text" class="blank-input" data-answer="石油煉製" style="width: 80px;">業及<input type="text" class="blank-input" data-answer="石油輸入" style="width: 80px;">業經營能源業務收入之提撥。二、基金之<input type="text" class="blank-input" data-answer="孳息" style="width: 40px;">。三、能源技術服務、<input type="text" class="blank-input" data-answer="權利金" style="width: 60px;">、<input type="text" class="blank-input" data-answer="報酬金" style="width: 60px;">及其他有關收入。</p>
                </div>
                
                <div class="question">
                    <p>9. 前項第一款之提撥，由中央主管機關就綜合電業、石油煉製業及石油輸入業每年經營能源業務收入之<input type="text" class="blank-input" data-answer="千分之五" style="width: 80px;">範圍內收取。</p>
                </div>
                
                <h2>第二章 能源供應</h2>
                <div class="question">
                    <p>10. 能源供應事業經營能源業務，應遵行中央主管機關關於能源之<input type="text" class="blank-input" data-answer="調節" style="width: 40px;">、<input type="text" class="blank-input" data-answer="限制" style="width: 40px;">、<input type="text" class="blank-input" data-answer="禁止" style="width: 40px;">之規定。</p>
                </div>
                
                <div class="question">
                    <p>11. 經中央主管機關指定之能源產品，其<input type="text" class="blank-input" data-answer="輸入" style="width: 40px;">、<input type="text" class="blank-input" data-answer="輸出" style="width: 40px;">、<input type="text" class="blank-input" data-answer="生產" style="width: 40px;">、<input type="text" class="blank-input" data-answer="銷售" style="width: 40px;">業務，非經<input type="text" class="blank-input" data-answer="許可" style="width: 40px;">不得經營。</p>
                </div>
                
                <div class="question">
                    <p>12. 前項許可管理辦法，由<input type="text" class="blank-input" data-answer="中央主管機關" style="width: 100px;">訂定，並送<input type="text" class="blank-input" data-answer="立法院" style="width: 60px;">。</p>
                </div>
                
                <div class="question">
                    <p>13. 能源供應事業經營能源業務，達中央主管機關規定之數量者，應依照中央主管機關之規定，辦理左列事項：一、申報<input type="text" class="blank-input" data-answer="經營資料" style="width: 80px;">。二、設置能源<input type="text" class="blank-input" data-answer="儲存" style="width: 40px;">設備。三、儲存<input type="text" class="blank-input" data-answer="安全" style="width: 40px;">存量。</p>
                </div>
                
                <div class="question">
                    <p>14. 依前項第二款規定設置儲存設備，於課徵<input type="text" class="blank-input" data-answer="營利事業" style="width: 80px;">所得稅時，得按<input type="text" class="blank-input" data-answer="二年" style="width: 40px;">加速折舊。但在二年內如未折舊足額，得於所得稅法規定之<input type="text" class="blank-input" data-answer="耐用年限" style="width: 80px;">一年或分年繼續折舊，至折足為止。</p>
                </div>
                
                <h2>第三章 能源使用與查核</h2>
                <div class="question">
                    <p>15. 經中央主管機關指定之既有能源用戶所使用之照明、動力、電熱、空調、冷凍冷藏或其他使用能源之設備，其能源之<input type="text" class="blank-input" data-answer="使用" style="width: 40px;">及<input type="text" class="blank-input" data-answer="效率" style="width: 40px;">，應符合中央主管機關所定<input type="text" class="blank-input" data-answer="節約能源" style="width: 80px;">之規定。</p>
                </div>
                
                <div class="question">
                    <p>16. 前項能源用戶之指定、使用能源設備之<input type="text" class="blank-input" data-answer="種類" style="width: 40px;">、節約能源及能源使用效率之規定，由<input type="text" class="blank-input" data-answer="中央主管機關公告" style="width: 120px;">之。</p>
                </div>
                
                <div class="question">
                    <p>17. 能源用戶使用能源達中央主管機關規定數量者，應建立能源<input type="text" class="blank-input" data-answer="查核" style="width: 40px;">制度，並訂定<input type="text" class="blank-input" data-answer="節約能源" style="width: 80px;">目標及<input type="text" class="blank-input" data-answer="執行" style="width: 40px;">計畫，報經中央主管機關<input type="text" class="blank-input" data-answer="核備" style="width: 40px;">並執行之。</p>
                </div>
                
                <div class="question">
                    <p>18. 能源用戶生產<input type="text" class="blank-input" data-answer="蒸汽" style="width: 40px;">達中央主管機關規定數量者，應裝設<input type="text" class="blank-input" data-answer="汽電共生" style="width: 80px;">設備。</p>
                </div>
                
                <div class="question">
                    <p>19. 能源用戶裝設汽電共生設備，<input type="text" class="blank-input" data-answer="有效熱能" style="width: 80px;">比率及<input type="text" class="blank-input" data-answer="總熱效率" style="width: 80px;">達中央主管機關規定者，得請當地綜合電業收購其生產電能之<input type="text" class="blank-input" data-answer="餘電" style="width: 40px;">，與提供系統維修或故障所需<input type="text" class="blank-input" data-answer="備用" style="width: 40px;">電力。當地綜合電業除有<input type="text" class="blank-input" data-answer="正當" style="width: 40px;">理由，並經中央主管機關核准外，不得<input type="text" class="blank-input" data-answer="拒絕" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>20. 前項收購餘電費率、汽電共生有效熱能比率與總熱效率<input type="text" class="blank-input" data-answer="基準" style="width: 40px;">及<input type="text" class="blank-input" data-answer="查驗" style="width: 40px;">方式之辦法，及裝設汽電共生之能源用戶與綜合電業相互<input type="text" class="blank-input" data-answer="併聯" style="width: 40px;">、電能收購方式、購電與備用電力<input type="text" class="blank-input" data-answer="費率" style="width: 40px;">及收購餘電<input type="text" class="blank-input" data-answer="義務" style="width: 40px;">之執行期間等事項之辦法，由中央主管機關定之。</p>
                </div>
                
                <div class="question">
                    <p>21. 能源用戶使用能源達中央主管機關規定數量者，應依其能源使用量<input type="text" class="blank-input" data-answer="級距" style="width: 40px;">，自置或委託一定<input type="text" class="blank-input" data-answer="名額" style="width: 40px;">之技師或合格<input type="text" class="blank-input" data-answer="能源管理人員" style="width: 100px;">負責執行第八條、第九條及第十二條中央主管機關規定之業務。</p>
                </div>
                
                <div class="question">
                    <p>22. 前項能源使用級距、技師或能源管理人員之<input type="text" class="blank-input" data-answer="名額" style="width: 40px;">、<input type="text" class="blank-input" data-answer="資格" style="width: 40px;">、<input type="text" class="blank-input" data-answer="訓練" style="width: 40px;">、合格證書取得之<input type="text" class="blank-input" data-answer="程序" style="width: 40px;">、條件、<input type="text" class="blank-input" data-answer="撤銷" style="width: 40px;">、<input type="text" class="blank-input" data-answer="廢止" style="width: 40px;">、<input type="text" class="blank-input" data-answer="查核" style="width: 40px;">、管理及其他應遵行事項之辦法，由中央主管機關定之。</p>
                </div>
                
                <div class="question">
                    <p>23. 能源用戶使用能源達中央主管機關規定數量者，應向中央主管機關<input type="text" class="blank-input" data-answer="申報" style="width: 40px;">使用能源資料。</p>
                </div>
                
                <div class="question">
                    <p>24. 前項能源用戶應申報使用能源之<input type="text" class="blank-input" data-answer="種類" style="width: 40px;">、<input type="text" class="blank-input" data-answer="數量" style="width: 40px;">、<input type="text" class="blank-input" data-answer="項目" style="width: 40px;">、<input type="text" class="blank-input" data-answer="效率" style="width: 40px;">、<input type="text" class="blank-input" data-answer="申報期間" style="width: 80px;">及方式，由中央主管機關<input type="text" class="blank-input" data-answer="公告" style="width: 40px;">之。</p>
                </div>
                
                <div class="question">
                    <p>25. 廠商製造或進口中央主管機關指定之使用能源設備或器具供國內使用者，其能源設備或器具之能源<input type="text" class="blank-input" data-answer="效率" style="width: 40px;">，應符合中央主管機關容許<input type="text" class="blank-input" data-answer="耗用能源" style="width: 80px;">之規定，並應標示能源<input type="text" class="blank-input" data-answer="耗用" style="width: 40px;">量及其<input type="text" class="blank-input" data-answer="效率" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>26. 不符合前項容許耗用能源規定之使用能源設備或器具，不准<input type="text" class="blank-input" data-answer="進口" style="width: 40px;">或在國內<input type="text" class="blank-input" data-answer="銷售" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>27. 未依第一項規定<input type="text" class="blank-input" data-answer="標示" style="width: 40px;">之使用能源設備或器具，不得在國內<input type="text" class="blank-input" data-answer="陳列" style="width: 40px;">或<input type="text" class="blank-input" data-answer="銷售" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>28. 第一項使用能源設備或器具之<input type="text" class="blank-input" data-answer="種類" style="width: 40px;">、容許耗用能源<input type="text" class="blank-input" data-answer="基準" style="width: 40px;">與其檢查方式、能源耗用量及其效率之<input type="text" class="blank-input" data-answer="標示" style="width: 40px;">事項、方法、檢查方式，由中央主管機關<input type="text" class="blank-input" data-answer="公告" style="width: 40px;">之。</p>
                </div>
                
                <div class="question">
                    <p>29. 廠商製造或進口中央主管機關指定之<input type="text" class="blank-input" data-answer="車輛" style="width: 40px;">供國內使用者，其車輛之能源效率，應符合中央主管機關容許耗用能源之規定，並應標示能源<input type="text" class="blank-input" data-answer="耗用" style="width: 40px;">量及其<input type="text" class="blank-input" data-answer="效率" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>30. 不符合前項容許耗用能源規定之車輛，不准<input type="text" class="blank-input" data-answer="進口" style="width: 40px;">或在國內<input type="text" class="blank-input" data-answer="銷售" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>31. 未依第一項規定標示之車輛，不得在國內<input type="text" class="blank-input" data-answer="陳列" style="width: 40px;">或<input type="text" class="blank-input" data-answer="銷售" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>32. 第一項車輛容許耗用能源基準、能源耗用量與其效率之標示事項、方法、檢查方式、<input type="text" class="blank-input" data-answer="證明文件" style="width: 80px;">之核發、撤銷或廢止、管理及其他相關事項之辦法，由中央主管機關會同<input type="text" class="blank-input" data-answer="中央交通主管機關" style="width: 120px;">定之。</p>
                </div>
                
                <div class="question">
                    <p>33. 中央主管機關應依第一條第二項能源發展綱領，就全國能源<input type="text" class="blank-input" data-answer="分期分區" style="width: 80px;">供給容量及效率規定，訂定<input type="text" class="blank-input" data-answer="能源開發及使用評估" style="width: 140px;">準則，作為國內能源開發及使用之<input type="text" class="blank-input" data-answer="審查" style="width: 40px;">準據。</p>
                </div>
                
                <div class="question">
                    <p>34. 大型投資生產計畫之能源用戶新設或擴建能源使用設施，其能源使用數量對國家整體能源<input type="text" class="blank-input" data-answer="供需" style="width: 40px;">與<input type="text" class="blank-input" data-answer="結構" style="width: 40px;">及區域<input type="text" class="blank-input" data-answer="平衡" style="width: 40px;">造成重大影響者，應製作<input type="text" class="blank-input" data-answer="能源使用說明書" style="width: 120px;">送請受理許可申請之機關，轉送中央主管機關<input type="text" class="blank-input" data-answer="核准" style="width: 40px;">後，始得新設或擴建。</p>
                </div>
                
                <div class="question">
                    <p>35. 中央主管機關為前項核准前，應依前條所定能源開發及使用評估準則，對能源用戶之使用<input type="text" class="blank-input" data-answer="數量" style="width: 40px;">、<input type="text" class="blank-input" data-answer="種類" style="width: 40px;">、<input type="text" class="blank-input" data-answer="效率" style="width: 40px;">及<input type="text" class="blank-input" data-answer="區位" style="width: 40px;">等事項進行審查。</p>
                </div>
                
                <div class="question">
                    <p>36. 新建建築物之<input type="text" class="blank-input" data-answer="設計" style="width: 40px;">與<input type="text" class="blank-input" data-answer="建造" style="width: 40px;">之有關節約能源標準，由<input type="text" class="blank-input" data-answer="建築主管機關" style="width: 100px;">會同中央主管機關定之。</p>
                </div>
                
                <div class="question">
                    <p>37. 能源用戶裝設中央空氣調節系統，且其<input type="text" class="blank-input" data-answer="冷凍主機" style="width: 80px;">容量達中央主管機關規定數額者，應裝設個別<input type="text" class="blank-input" data-answer="電表" style="width: 40px;">及<input type="text" class="blank-input" data-answer="線路" style="width: 40px;">。</p>
                </div>
                
                <div class="question">
                    <p>38. 綜合電業為實施中央空氣調節系統用電之<input type="text" class="blank-input" data-answer="負載管理" style="width: 80px;">，得經中央主管機關核准，採行<input type="text" class="blank-input" data-answer="差別費率" style="width: 80px;">。</p>
                </div>
                
                <div class="question">
                    <p>39. 中央主管機關於能源供應<input type="text" class="blank-input" data-answer="不足" style="width: 40px;">時，得訂定能源<input type="text" class="blank-input" data-answer="管制" style="width: 40px;">、<input type="text" class="blank-input" data-answer="限制" style="width: 40px;">及<input type="text" class="blank-input" data-answer="配售" style="width: 40px;">辦法，報請<input type="text" class="blank-input" data-answer="行政院" style="width: 60px;">核定施行之。</p>
                </div>
                
                <div class="question">
                    <p>40. 中央主管機關得派員或委託<input type="text" class="blank-input" data-answer="專業機構" style="width: 80px;">或<input type="text" class="blank-input" data-answer="技師" style="width: 40px;">，對於本法公告或指定之能源用戶、使用能源設備、器具或車輛之製造、進口廠商或販賣業者，實施<input type="text" class="blank-input" data-answer="檢查" style="width: 40px;">或命其提供有關<input type="text" class="blank-input" data-answer="資料" style="width: 40px;">，能源用戶、製造、進口廠商及販賣業者不得<input type="text" class="blank-input" data-answer="規避" style="width: 40px;">、<input type="text" class="blank-input" data-answer="妨礙" style="width: 40px;">或<input type="text" class="blank-input" data-answer="拒絕" style="width: 40px;">。</p>
                </div>
                
                <h2>第四章 罰則</h2>
                <div class="question">
                    <p>41. 能源供應事業違反中央主管機關依第六條第一項所為之規定者，主管機關應通知<input type="text" class="blank-input" data-answer="限期" style="width: 40px;">辦理；逾期不遵行者，處新臺幣<input type="text" class="blank-input" data-answer="一萬五千元" style="width: 80px;">以上<input type="text" class="blank-input" data-answer="十五萬元" style="width: 80px;">以下罰鍰，並再限期辦理；逾期仍不遵行者，除<input type="text" class="blank-input" data-answer="加倍處罰" style="width: 80px;">外，並得<input type="text" class="blank-input" data-answer="停止" style="width: 40px;">其營業或<input type="text" class="blank-input" data-answer="勒令歇業" style="width: 80px;">。</p>
                </div>
                
                <div class="question">
                    <p>42. 未經許可而經營中央主管機關指定之能源產品之輸入、輸出、生產、銷售業務者，處<input type="text" class="blank-input" data-answer="一年以下" style="width: 60px;">有期徒刑、拘役或科或併科新臺幣<input type="text" class="blank-input" data-answer="三十萬元" style="width: 80px;">以下罰金。</p>
                </div>
                
                <div class="question">
                    <p>43. 有下列情形之一者，主管機關應通知限期改善；屆期不改善者，處新臺幣<input type="text" class="blank-input" data-answer="二萬元" style="width: 60px;">以上<input type="text" class="blank-input" data-answer="十萬元" style="width: 60px;">以下罰鍰，並再限期改善；屆期仍不改善者，按次<input type="text" class="blank-input" data-answer="加倍" style="width: 40px;">處罰：<br>
                    一、未依第七條第一項第一款規定<input type="text" class="blank-input" data-answer="申報" style="width: 40px;">經營資料或申報不實。<br>
                    二、未依第十一條第一項規定<input type="text" class="blank-input" data-answer="自置" style="width: 40px;">或<input type="text" class="blank-input" data-answer="委託" style="width: 40px;">技師或合格能源管理人員執行中央主管機關規定之業務。<br>
                    三、未依第十二條第一項規定<input type="text" class="blank-input" data-answer="申報" style="width: 40px;">使用能源資料或申報不實。<br>
                    四、未依第十四條第一項或第十五條第一項規定<input type="text" class="blank-input" data-answer="標示" style="width: 40px;">能源耗用量及其效率或標示不實。<br>
                    五、違反第十四條第三項或第十五條第三項規定，<input type="text" class="blank-input" data-answer="陳列" style="width: 40px;">或<input type="text" class="blank-input" data-answer="銷售" style="width: 40px;">未依法標示之使用能源設備、器具或車輛。</p>
                </div>
                
                <div class="question">
                    <p>44. 能源供應事業違反第七條第一項第二款、第三款未設置能源儲存設備或儲存安全存量者，主管機關應通知<input type="text" class="blank-input" data-answer="限期" style="width: 40px;">辦理；逾期不遵行者，處新台幣<input type="text" class="blank-input" data-answer="十五萬元" style="width: 80px;">以上<input type="text" class="blank-input" data-answer="六十萬元" style="width: 80px;">以下罰鍰，並再限期辦理；逾期仍不遵行者，得<input type="text" class="blank-input" data-answer="加倍" style="width: 40px;">處罰。</p>
                </div>
                
                <div class="question">
                    <p>45. 能源用戶違反中央主管機關依第八條所定關於能源使用及效率之規定者，主管機關應<input type="text" class="blank-input" data-answer="限期" style="width: 40px;">命其改善或<input type="text" class="blank-input" data-answer="更新" style="width: 40px;">設備；屆期不改善或更新設備者，處新臺幣<input type="text" class="blank-input" data-answer="二萬元" style="width: 60px;">以上<input type="text" class="blank-input" data-answer="十萬元" style="width: 60px;">以下罰鍰，並再限期辦理；屆期仍不改善者，按次<input type="text" class="blank-input" data-answer="加倍" style="width: 40px;">處罰。</p>
                </div>
                
                <div class="question">
                    <p>46. 能源用戶違反第十六條第一項未經核准而新設或擴建者，中央主管機關得禁止其<input type="text" class="blank-input" data-answer="輸入" style="width: 40px;">能源或命能源供應事業<input type="text" class="blank-input" data-answer="停供" style="width: 40px;">能源。</p>
                </div>
                
                <div class="question">
                    <p>47. 能源用戶違反依第十七條所定之節約能源標準者，得<input type="text" class="blank-input" data-answer="停供" style="width: 40px;">其能源。</p>
                </div>
                
                <div class="question">
                    <p>48. 違反中央主管機關依第十九條所定之能源管制、限制及配售辦法者，主管機關應通知<input type="text" class="blank-input" data-answer="限期" style="width: 40px;">辦理；逾期不遵行者，處新台幣<input type="text" class="blank-input" data-answer="一萬五千元" style="width: 80px;">以上<input type="text" class="blank-input" data-answer="十五萬元" style="width: 80px;">以下罰鍰，並得<input type="text" class="blank-input" data-answer="停供" style="width: 40px;">其能源。</p>
                </div>
                
                <h2>第五章 附則</h2>
                <div class="question">
                    <p>49. 本法施行細則，由<input type="text" class="blank-input" data-answer="中央主管機關" style="width: 100px;">訂定，報請<input type="text" class="blank-input" data-answer="行政院" style="width: 60px;">核定之。</p>
                </div>
                
                <div class="question">
                    <p>50. 本法自<input type="text" class="blank-input" data-answer="公布日" style="width: 60px;">施行。</p>
                </div>
            </div>
            
            <div class="buttons">
                <button type="button" id="reset">重設</button>
                <button type="button" id="show-answers">顯示答案</button>
                <button type="button" id="check-results" class="results-button">查看成績</button>
                <button type="submit">提交</button>
            </div>
        </form>
    </div>
    
    <!-- 成績結果模態框 -->
    <div id="score-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-modal">&times;</span>
            <div class="modal-header">
                <h2>測驗成績</h2>
            </div>
            <div class="score-display">
                <div class="score-circle" id="score-percentage">--</div>
                <div class="grade" id="grade-display">評級: --</div>
                <div class="feedback" id="feedback-text">--</div>
            </div>
            <div class="score-details">
                <p>總題數: <span id="total-questions">--</span></p>
                <p>答對題數: <span id="correct-answers">--</span></p>
                <p>答錯題數: <span id="wrong-answers">--</span></p>
                <p>未作答題數: <span id="unanswered">--</span></p>
            </div>
            <div class="modal-actions">
                <button id="show-correct-answers">顯示正確答案</button>
                <button id="close-modal-button">繼續練習</button>
            </div>
        </div>
    </div>

    <script>
        // 更新進度條
        function updateProgress() {
            const inputs = document.querySelectorAll('.blank-input');
            let filledCount = 0;
            
            inputs.forEach(input => {
                if (input.value.trim() !== '') {
                    filledCount++;
                }
            });
            
            const totalInputs = inputs.length;
            const progressPercentage = totalInputs > 0 ? (filledCount / totalInputs) * 100 : 0;
            document.getElementById('progress-bar').style.width = progressPercentage + '%';
            document.getElementById('progress-text').textContent = `${filledCount}/${totalInputs} (${progressPercentage.toFixed(1)}%)`;
        }

        // 顯示答案
        function showAnswers() {
            const inputs = document.querySelectorAll('.blank-input');
            inputs.forEach(input => {
                input.value = input.dataset.answer;
            });
            updateProgress();
        }
        
        // 計算成績
        function calculateScore() {
            const inputs = document.querySelectorAll('.blank-input');
            let totalQuestions = inputs.length;
            let correctAnswers = 0;
            let wrongAnswers = 0;
            let unanswered = 0;
            
            inputs.forEach(input => {
                const userAnswer = input.value.trim();
                const correctAnswer = input.dataset.answer;
                
                if (userAnswer === '') {
                    unanswered++;
                } else if (userAnswer === correctAnswer) {
                    correctAnswers++;
                    input.classList.add('correct-answer');
                } else {
                    wrongAnswers++;
                    input.classList.add('wrong-answer');
                }
            });
            
            const scorePercentage = totalQuestions > 0 ? 
                Math.round((correctAnswers / totalQuestions) * 100) : 0;
            
            let grade;
            let feedback;
            
            if (scorePercentage >= 90) {
                grade = "優等 (A+)";
                feedback = "太棒了！你對能源管理法有極深入的理解！";
            } else if (scorePercentage >= 80) {
                grade = "甲等 (A)";
                feedback = "表現優秀，你已經熟悉能源管理法的大部分內容！";
            } else if (scorePercentage >= 70) {
                grade = "乙等 (B+)";
                feedback = "表現不錯，繼續努力可以更上一層樓！";
            } else if (scorePercentage >= 60) {
                grade = "丙等 (B)";
                feedback = "及格了，但還有提升空間，建議多加練習！";
            } else if (scorePercentage >= 50) {
                grade = "丁等 (C)";
                feedback = "還需要更多學習和記憶，再接再厲！";
            } else {
                grade = "戊等 (D)";
                feedback = "建議重新學習能源管理法的內容，加油！";
            }
            
            return {
                totalQuestions,
                correctAnswers,
                wrongAnswers,
                unanswered,
                scorePercentage,
                grade,
                feedback
            };
        }
        
        // 顯示成績模態框
        function showScoreModal() {
            const score = calculateScore();
            
            document.getElementById('score-percentage').textContent = score.scorePercentage + "%";
            document.getElementById('grade-display').textContent = "評級: " + score.grade;
            document.getElementById('feedback-text').textContent = score.feedback;
            document.getElementById('total-questions').textContent = score.totalQuestions;
            document.getElementById('correct-answers').textContent = score.correctAnswers;
            document.getElementById('wrong-answers').textContent = score.wrongAnswers;
            document.getElementById('unanswered').textContent = score.unanswered;
            
            document.getElementById('score-modal').style.display = "block";
        }
        
        // 關閉模態框
        function closeModal() {
            document.getElementById('score-modal').style.display = "none";
        }
        
        // 顯示正確答案並高亮錯誤
        function showCorrectAndWrongAnswers() {
            const inputs = document.querySelectorAll('.blank-input');
            
            inputs.forEach(input => {
                const userAnswer = input.value.trim();
                const correctAnswer = input.dataset.answer;
                
                if (userAnswer !== correctAnswer) {
                    input.value = correctAnswer;
                    input.classList.add('correct-answer');
                }
            });
            
            closeModal();
        }

        // 事件監聽器設置
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化進度顯示
            updateProgress();
            
            // 重設按鈕
            document.getElementById('reset').addEventListener('click', function() {
                document.querySelectorAll('.blank-input').forEach(input => {
                    input.value = '';
                    input.classList.remove('correct-answer', 'wrong-answer');
                });
                updateProgress();
            });
            
            // 顯示答案按鈕
            document.getElementById('show-answers').addEventListener('click', showAnswers);
            
            // 查看成績按鈕
            document.getElementById('check-results').addEventListener('click', showScoreModal);
            
            // 關閉模態框按鈕
            document.getElementById('close-modal').addEventListener('click', closeModal);
            document.getElementById('close-modal-button').addEventListener('click', closeModal);
            
            // 顯示正確答案按鈕
            document.getElementById('show-correct-answers').addEventListener('click', showCorrectAndWrongAnswers);
            
            // 監聽所有輸入框的變化
            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('blank-input')) {
                    updateProgress();
                }
            });
            
            // 提交表單
            document.getElementById('quiz-form').addEventListener('submit', function(e) {
                e.preventDefault();
                showScoreModal();
            });
            
            // 點擊模態框外部關閉模態框
            window.addEventListener('click', function(e) {
                const modal = document.getElementById('score-modal');
                if (e.target === modal) {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>